<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Allan Farrell">
<meta name="dcterms.date" content="2025-01-24">
<meta name="description" content="Evaluating approaches to ideal gas blowdowns.">

<title>Vessel Blowdown - Ideal Gases – A Chemical Engineer’s Notebook</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-59228ce9c52eba116baca5d538563979.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: #ffffff;
      }

      .quarto-title-block .quarto-title-banner {
        color: #ffffff;
background: url(../../images/pexels-daniil-prikhno-header.jpg);
      }
</style>
<style>
.quarto-title-block .quarto-title-banner {
  min-height: 100%;
  background-size: cover;
  box-shadow: inset 0 0 0 2000px rgba(0, 0, 0, 0.3);
}
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Vessel Blowdown - Ideal Gases – A Chemical Engineer’s Notebook">
<meta property="og:description" content="Evaluating approaches to ideal gas blowdowns.">
<meta property="og:image" content="https://aefarrell.github.io/posts/vessel_blowdown_ideal_gases/pressure_relief.png">
<meta property="og:site_name" content="A Chemical Engineer's Notebook">
<meta property="og:image:height" content="777">
<meta property="og:image:width" content="1483">
</head>

<body class="floating nav-fixed slimcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">A Chemical Engineer’s Notebook</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> <i class="bi bi-info-circle" role="img">
</i> 
<span class="menu-text">about</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html"> <i class="bi bi-wrench-adjustable-circle" role="img">
</i> 
<span class="menu-text">projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../archive.html"> <i class="bi bi-archive" role="img">
</i> 
<span class="menu-text">posts</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/aefarrell/aefarrell.github.io/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Vessel Blowdown - Ideal Gases</h1>
                  <div>
        <div class="description">
          Evaluating approaches to ideal gas blowdowns.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">julia</div>
                <div class="quarto-category">compressible flow</div>
                <div class="quarto-category">blowdown</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Allan Farrell </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 24, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="3">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#the-adiabatic-case" id="toc-the-adiabatic-case" class="nav-link active" data-scroll-target="#the-adiabatic-case">The Adiabatic Case</a>
  <ul class="collapse">
  <li><a href="#fully-choked-flow" id="toc-fully-choked-flow" class="nav-link" data-scroll-target="#fully-choked-flow">Fully Choked Flow</a></li>
  <li><a href="#in-the-literature" id="toc-in-the-literature" class="nav-link" data-scroll-target="#in-the-literature">In the Literature</a></li>
  <li><a href="#the-complete-ode" id="toc-the-complete-ode" class="nav-link" data-scroll-target="#the-complete-ode">The Complete ODE</a></li>
  <li><a href="#a-motivating-example" id="toc-a-motivating-example" class="nav-link" data-scroll-target="#a-motivating-example">A Motivating Example</a></li>
  </ul></li>
  <li><a href="#the-isothermal-case" id="toc-the-isothermal-case" class="nav-link" data-scroll-target="#the-isothermal-case">The Isothermal Case</a>
  <ul class="collapse">
  <li><a href="#fully-choked-flow-1" id="toc-fully-choked-flow-1" class="nav-link" data-scroll-target="#fully-choked-flow-1">Fully Choked Flow</a></li>
  <li><a href="#in-the-literature-1" id="toc-in-the-literature-1" class="nav-link" data-scroll-target="#in-the-literature-1">In the Literature</a></li>
  </ul></li>
  <li><a href="#comparing-blowdown-models" id="toc-comparing-blowdown-models" class="nav-link" data-scroll-target="#comparing-blowdown-models">Comparing Blowdown Models</a></li>
  <li><a href="#final-thoughts" id="toc-final-thoughts" class="nav-link" data-scroll-target="#final-thoughts">Final Thoughts</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<p>A recurring task of mine is to look at some old calculations, done by some previous engineer whose identity is lost to time and organizational flux, and update them to match current reality. Depending on the state of the spreadsheet, and its lack of documentation, this can also mean going down a rabbit hole of research to find where, exactly, a given equation came from and what all the constants in it represent. This post is the result of one of those journeys, trying to track down the source of a model for depressuring a vessel.</p>
<div id="fig-sys" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sys-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="pressure_relief.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sys-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: A vessel blowdown scenario, discharging from vessel pressure (1), through an isentropic valve and into the atmosphere (2).
</figcaption>
</figure>
</div>
<p>Consider the blowdown of a pressure vessel to a vent stack, where the vessel contains a gas. What we want is the time to fully depressure and the pressure curve (the blowdown curve). As a first approximation we can consider the ideal gas case and examine two limiting behaviours for the vessel: when the walls are perfect insulators (the adiabatic case) and when the walls are perfect conductors of heat (the isothermal case). Furthermore we assume the blowdown is through an isentropic nozzle.</p>
<section id="the-adiabatic-case" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="the-adiabatic-case">The Adiabatic Case</h2>
<p>The adiabatic case is often a good approximation for small vessels and early in the blowdown, when the rate of energy lost from the vessel through the bulk transport of the gas is much higher than any heat gained from the environment.</p>
<p>Starting with a mass balance on the vessel:</p>
<p><span class="math display">\[
\frac{dm}{dt} = - w
\]</span></p>
<p>where <em>m</em> is the mass inside the vessel and <em>w</em> is the mass flow through the valve. Since the volume of the vessel is a constant, <em>V</em>, we can write the mass balance as</p>
<p><span class="math display">\[
V \frac{d \rho}{dt} = - w
\]</span></p>
<p>We can perform a change of variables from <em>ρ</em> to <em>P</em></p>
<p><span class="math display">\[
V \left( \frac{\partial \rho}{\partial P} \right)_S \frac{dP}{dt} = - w
\]</span></p>
<p>The partial derivative is taken along an isentropic path as the adiabatic expansion within the vessel is isentropic (not because the valve is isentropic).</p>
<p>We can write the mass flow through the nozzle in terms of the theoretical, friction less, mass velocity <em>G</em>, the discharge coefficient <span class="math inline">\(c_D\)</span>, and the flow area <em>A</em>.</p>
<p><span class="math display">\[
w = c_D A G
\]</span></p>
<p>giving<span class="citation" data-cites="botros-1989"><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></span></p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;<a href="#ref-botros-1989" role="doc-biblioref">Botros, Jungowski, and Weiss, <span>“Models and Methods of Simulating Gas Pipeline Blowdown”</span></a>.</p></div></div><p><span class="math display">\[
\frac{dP}{dt} = - \frac{c_D A}{V} \left( \frac{\partial P}{\partial \rho} \right)_S G
\]</span></p>
<section id="fully-choked-flow" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="fully-choked-flow">Fully Choked Flow</h3>
<p>Assuming the flow through the valve is choked, the velocity in the throat is the sonic velocity <span class="math inline">\(a_t\)</span> which, for an ideal gas, is given by</p>
<p><span class="math display">\[
a = \sqrt{ {k R T} \over M} = \sqrt{ {k P} \over \rho}
\]</span></p>
<p>An ideal gas undergoing an adiabatic expansion from vessel pressure to the pressure in the throat of the valve has the following relationship between density and pressure<span class="citation" data-cites="laidler-2003"><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></span></p>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>&nbsp;Any physical chemistry textbook, such as <a href="#ref-laidler-2003" role="doc-biblioref">Laidler, Meiser, and Sanctuary, <em>Physical Chemistry</em>, 79–81</a>.</p></div></div><p><span class="math display">\[
\frac{\rho_t}{\rho} = \left( \frac{P_t}{P} \right)^{\frac{1}{k} }
\]</span></p>
<p>and, for choked flow, the pressure ratio is at maximum at<span class="citation" data-cites="tilton-2008"><a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></span></p>
<div class="no-row-height column-margin column-container"><div id="fn3"><p><sup>3</sup>&nbsp;<a href="#ref-tilton-2008" role="doc-biblioref">Tilton, <span>“Fluid and Particle Dynamics,”</span> 6-22-6-23</a>.</p></div></div><p><span class="math display">\[
\frac{P_t}{P} = \left( { 2 \over {k+1} } \right)^{\frac{k}{k-1} }
\]</span></p>
<p>putting this all together we can write <em>G</em> in terms of vessel conditions <span class="math inline">\(\rho\)</span> and <span class="math inline">\(P\)</span></p>
<p><span class="math display">\[
G = \rho_t u_t = \rho_t a_t = \rho_t \sqrt{ {k P_t} \over \rho_t} = \sqrt{k \rho_t P_t}
\]</span></p>
<p><span class="math display">\[
G = \sqrt{k \rho P} \left( 2 \over {k+1} \right)^{\frac{k+1}{2 \left( k - 1 \right)} }
\]</span></p>
<p>From <a href="../../posts/relief_valve_sizing/">thermodynamics</a> we know</p>
<p><span class="math display">\[
\left( \frac{\partial P}{\partial \rho} \right)_S = a^2 = \frac{k P}{\rho}
\]</span></p>
<p>and we can put this all together to get</p>
<p><span class="math display">\[
\frac{dP}{dt} = - \frac{c_D A}{V} \left( {k P} \over \rho \right) \sqrt{k \rho P} \left( 2 \over {k+1} \right)^{\frac{k+1}{2 \left( k - 1 \right)} }
\]</span></p>
<p>At this point, it is standard to introduce a time constant <span class="math inline">\(\tau\)</span></p>
<p><span class="math display">\[
\tau = \frac{m_0}{w_0} = \frac{\rho_0 V}{c_D A \sqrt{k \rho_0 P_0} } \left( 2 \over {k+1} \right)^{-\frac{k+1}{2 \left( k - 1 \right)} }
\]</span></p>
<p>or, more clearly,</p>
<p><span class="math display">\[
\frac{1}{\tau} = \frac{c_D A}{V} \sqrt{ {k P_0} \over \rho_0 } \left( 2 \over {k+1} \right)^{\frac{k+1}{2 \left( k - 1 \right)} }
\]</span></p>
<p>Where the subscript 0 indicates the <em>initial conditions in the vessel</em>. This simplifies the expression to</p>
<p><span class="math display">\[
\frac{dP}{dt} = -\frac{k}{\tau} P \left( \frac{P}{P_0} \right)^{\frac{k-1}{2k} }
\]</span></p>
<p>Which is separable and can be integrated to give (after some rearrangement)</p>
<p><span class="math display">\[
\frac{P}{P_0} = \left( 1 + \left( {k-1} \over 2 \right) \frac{t}{\tau} \right)^{\frac{2k}{1-k} }
\]</span></p>
<p>and the depressure time is</p>
<p><span class="math display">\[
t = \frac{2\tau}{1-k} \left( 1 - \left( \frac{P_a}{P_0} \right)^{\frac{1-k}{2k} } \right)
\]</span></p>
<p>Another useful thing to determine is the mass flow rate over time, which can be recovered rather easily recalling</p>
<p><span class="math display">\[
w = -\frac{V}{a^2} \frac{dP}{dt} = -\frac{\rho V}{k P} \frac{dP}{dt}
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\frac{dP}{dt} = -\frac{k}{\tau} P \left( \frac{P}{P_0} \right)^{\frac{k-1}{2k} }
\]</span></p>
<p>we get</p>
<p><span class="math display">\[
w = \frac{\rho V}{\tau} \left( \frac{P}{P_0} \right)^{\frac{k-1}{2k} } = \frac{\rho_0 V}{\tau} \left( \frac{\rho}{\rho_0} \right) \left( \frac{P}{P_0} \right)^{\frac{k-1}{2k} }
\]</span></p>
<p>By recalling the definition of <span class="math inline">\(\tau\)</span> this simplifies to</p>
<p><span class="math display">\[
\frac{w}{w_0} = \left( \frac{P}{P_0} \right)^{ {k+1} \over {2k} } = \left( 1 + \left({k-1} \over 2 \right) \frac{t}{\tau} \right)^{\frac{1+k}{1-k} }
\]</span></p>
<p>This final model, for mass flow, is the model most often given in process safety references for blowdown rates. This makes some sense as early in a blowdown the observed pressure curve tend to approximate the adiabatic curve. However (foreshadowing) the isothermal curve leads to higher predicted vessel pressures, and generally higher mass flow rates, which might be more conservative depending on the context.</p>
</section>
<section id="in-the-literature" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="in-the-literature">In the Literature</h3>
<p>The adiabatic model is the only simple model given in Lees,<span class="citation" data-cites="lees-1996"><a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></span> with the recommendation to use software such as BLOWDOWN to handle more complex, multi phase, mixtures and heat transfer problems. This is also what my older copy of Perry’s gives,<span class="citation" data-cites="crowl-2008"><a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></span> albeit with a typo.</p>
<div class="no-row-height column-margin column-container"><div id="fn4"><p><sup>4</sup>&nbsp;<a href="#ref-lees-1996" role="doc-biblioref">Lees, <em>Loss Prevention in the Process Industries</em>, 15</a>/44.</p></div><div id="fn5"><p><sup>5</sup>&nbsp;<a href="#ref-crowl-2008" role="doc-biblioref">Crowl et al., <span>“Process Safety.”</span> 23–57</a>.</p></div></div><div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Perry’s gives the following</p>
<p><span class="math display">\[
\frac{w}{w_0} = \left( 1 + \left(\mathbf{k + 1} \over 2 \right) \frac{t}{\tau} \right)^{\frac{1+k}{1-k} }
\]</span></p>
<p>Note the sign change, it should be <strong>k-1</strong> not <strong>k+1</strong>, given typical values of <em>k</em>~1.4 this actually a huge difference.</p>
</div>
</div>
<p>Perry’s only gives the mass flow, so if you wanted the pressure (and the gas density and temperature) you would need to find some other reference. Or do it yourself, it does sketch out how the equation is derived, if you have the spare time to sit down and integrate.</p>
</section>
<section id="the-complete-ode" class="level3">
<h3 class="anchored" data-anchor-id="the-complete-ode">The Complete ODE</h3>
<p>There are two obvious limitations to this model: it relies on the gas being well approximated by an ideal gas and that the flow out of the vessel is always choked. The first issue I am not going to deal with right now, the second one I think can be easily dealt with by slightly modifying the governing equations.</p>
<p><span class="math display">\[
\frac{dP}{dt} = -\frac{c_D A}{V} a^2 G
\]</span></p>
<p>We can solve this numerically given</p>
<p><span class="math display">\[
\rho = \rho_0 \left(\frac{P}{P_0}\right)^{\frac{1}{k} }
\]</span></p>
<p><span class="math display">\[
G = \sqrt{ \rho P \left( {2k} \over {k - 1} \right) \left( \left( \frac{P_t}{P}\right)^{ \frac{2}{k} } - \left( \frac{P_t}{P} \right)^{ \frac{k+1}{k} } \right) }
\]</span></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">isentropic_mass_flow</span>(P, ρ; k<span class="op">=</span><span class="fl">1.4</span>, Pₐ<span class="op">=</span><span class="fl">101325</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    η <span class="op">=</span> <span class="fu">max</span>( Pₐ<span class="op">/</span>P, (<span class="fl">2</span><span class="op">/</span>(k<span class="op">+</span><span class="fl">1</span>))<span class="op">^</span>(k<span class="op">/</span>(k<span class="op">-</span><span class="fl">1</span>)))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    G² <span class="op">=</span> <span class="fu">ρ*P*</span>(<span class="fl">2</span>k<span class="op">/</span>(k<span class="op">-</span><span class="fl">1</span>))<span class="fu">*</span>( η<span class="op">^</span>(<span class="fl">2</span><span class="op">/</span>k) <span class="op">-</span> η<span class="op">^</span>((k<span class="op">+</span><span class="fl">1</span>)<span class="op">/</span>k) )</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    G <span class="op">=</span> G² <span class="op">&gt;</span> <span class="fl">0</span> ? <span class="fu">√</span>(G²) <span class="op">:</span> <span class="fl">0</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> G</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">speed_of_sound</span>(P, ρ; k<span class="op">=</span><span class="fl">1.4</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> <span class="fu">√</span>(k<span class="op">*</span>P<span class="op">/</span>ρ)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">adiabatic_vessel</span>(P, params, t)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    c, A, V, k, ρ₀, P₀, Pₐ <span class="op">=</span> params</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    ρ <span class="op">=</span> <span class="fu">ρ₀*</span>(P<span class="op">/</span>P₀)<span class="op">^</span>(<span class="fl">1</span><span class="op">/</span>k)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    a² <span class="op">=</span> <span class="fu">speed_of_sound</span>(P, ρ; k<span class="op">=</span>k)<span class="op">^</span><span class="fl">2</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    G <span class="op">=</span> <span class="fu">isentropic_mass_flow</span>(P, ρ; k<span class="op">=</span>k, Pₐ<span class="op">=</span>Pₐ)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span><span class="op">-</span>c<span class="op">*</span>A<span class="op">*</span>a²<span class="op">*</span>G<span class="op">/</span>V</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>with a callback function to terminate the integration once the vessel is fully depressured</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">depressured_callback</span>(P, t, integrator; tol<span class="op">=</span><span class="fl">0.001</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    c, A, V, k, ρ₀, P₀, Pₐ <span class="op">=</span> integrator.p</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> P <span class="op">-</span> (<span class="fl">1</span><span class="op">+</span>tol)<span class="op">*</span>Pₐ</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="a-motivating-example" class="level3">
<h3 class="anchored" data-anchor-id="a-motivating-example">A Motivating Example</h3>
<p>Just to have a real system to think about, I used to SCUBA dive when I was a teenager and had a few mishaps early on, when I was still figuring things out, accidentally opening the tank valve when the regulator yoke was not fully attached. Blasting air all over the place while I scrambled to shut it off. Typical tanks have capacities ranging from 80 cu. ft. to 100 cu. ft., with working pressures of &gt;3000 psi. That’s a pretty high pressure for a relatively small tank. How fast could the tank blowdown if I opened the valve fully and just sat back and watched?</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ambient conditions</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    Pₐ <span class="op">=</span> <span class="fl">101.325e3</span> <span class="co"># Pa</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    Tₐ <span class="op">=</span> <span class="fl">288.15</span>    <span class="co"># K</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    ρₐ <span class="op">=</span> <span class="fl">1.21</span>      <span class="co"># kg/m³</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>I looked around online and a typical tank with a <a href="https://www.divegearexpress.com/library/articles/calculating-scuba-cylinder-capacities">80 cu. ft. capacity</a> might have a “water volume” (actual internal volume) of 678 cu. in. (11.11L) and a working pressure of 3000 psi (20.68 MPa). I don’t actually know the flow area of a tank valve, I couldn’t find it easily, so I’m going to guess it’s basically a 1 mm diameter tube when fully open, with a discharge coefficient of 0.85 – all of this could be firmed up better with some real details of the valve. But this is a start.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Vessel conditions</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> <span class="fl">0.85</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    D <span class="op">=</span> <span class="fl">0.001</span>      <span class="co"># m</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    A <span class="op">=</span> <span class="fl">0.25</span><span class="op">*</span><span class="cn">π</span><span class="op">*</span>D<span class="op">^</span><span class="fl">2</span> <span class="co"># m²</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    V <span class="op">=</span> <span class="fl">0.01111</span>    <span class="co"># m³</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    P₀ <span class="op">=</span> <span class="fl">20.68e6</span>   <span class="co"># Pa</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    T₀ <span class="op">=</span> Tₐ</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    ρ₀ <span class="op">=</span> <span class="fu">ρₐ*</span>(P₀<span class="op">/</span>Pₐ) <span class="co"># ideal gas law</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    k <span class="op">=</span> <span class="fl">1.4</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>I then set up the differential equation and integrate to get the blowdown curve.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">OrdinaryDiffEq</span>, <span class="bu">Plots</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    params <span class="op">=</span> (c, A, V, k, ρ₀, P₀, Pₐ)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    t_span <span class="op">=</span> (<span class="fl">0.0</span>, <span class="fl">12.0</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    prob <span class="op">=</span> <span class="fu">ODEProblem</span>(adiabatic_vessel, P₀, t_span, params)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    sol <span class="op">=</span> <span class="fu">solve</span>(prob, <span class="fu">Tsit5</span>(),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                callback<span class="op">=</span><span class="fu">ContinuousCallback</span>(depressured_callback, terminate!))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig-1.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: The adiabatic blowdown curve for a fully charged SCUBA tank, showing both the fully choked model and the ODE solution.
</figcaption>
</figure>
</div>
<p>This model has the tank blowing down pretty fast, in less than 30s. Probably my guess for the valve area is too large. I did just make it up.</p>
<p>Regarding the models themselves, the adiabatic choked model is a very good approximation to the full ODE until the last few fractions of a second, at which point the models diverge. This likely to be true for any high pressure blowdowns, where the vessel pressure starts well above ~2atm, as in that case the majority of the blowdown will be entirely in the choked flow regime.</p>
<p>To play around with this more, I am first going to detour into creating some helper functions and I think this is a natural point to create a <code>struct</code> to contain the vessel parameters.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> PressureVessel{F <span class="op">&lt;:</span><span class="dt"> Number</span>}</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    c<span class="op">::</span><span class="dt">F</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    A<span class="op">::</span><span class="dt">F</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    V<span class="op">::</span><span class="dt">F</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    k<span class="op">::</span><span class="dt">F</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    ρ₀<span class="op">::</span><span class="dt">F</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    P₀<span class="op">::</span><span class="dt">F</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    Pₐ<span class="op">::</span><span class="dt">F</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    τ<span class="op">::</span><span class="dt">F</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="fu">PressureVessel</span>(c, A, V, k, ρ₀, P₀, Pₐ, τ) <span class="op">=</span> </span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">PressureVessel</span>(<span class="fu">promote</span>(c, A, V, k, ρ₀, P₀, Pₐ, τ)<span class="op">...</span>)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">PressureVessel</span>(c, A, V, k, ρ₀, P₀, Pₐ)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    τ <span class="op">=</span> <span class="fl">1</span><span class="op">/</span>( (c<span class="op">*</span>A<span class="op">/</span>V)<span class="fu">*√</span>(k<span class="op">*</span>P₀<span class="op">/</span>ρ₀)<span class="fu">*</span>(<span class="fl">2</span><span class="op">/</span>(k<span class="op">+</span><span class="fl">1</span>))<span class="op">^</span>((k<span class="op">+</span><span class="fl">1</span>)<span class="op">/</span>(<span class="fl">2</span><span class="fu">*</span>(k<span class="op">-</span><span class="fl">1</span>))) )</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">PressureVessel</span>(c, A, V, k, ρ₀, P₀, Pₐ, τ)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Where I have added a helper function to ensure all numbers are of the same type, and calculate the value of τ when the <code>PressureVessel</code> type is constructed.</p>
<p>Recreating the results from above, I start with a definition of the vessel</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>vessel <span class="op">=</span> <span class="fu">PressureVessel</span>(c, A, V, k, ρ₀, P₀, Pₐ);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>I would like to create some generic functions for the blowdown properties I am interested in: pressure and mass flow rate as functions of time and total blowdown time. To accommodate this I define another type to contain the <code>VesselBlowdown</code> solution.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">abstract type</span> Blowdown <span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> AdiabaticBlowdown{S} <span class="op">&lt;:</span><span class="dt"> Blowdown</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    pv<span class="op">::</span><span class="dt">PressureVessel</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    sol<span class="op">::</span><span class="dt">S</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Here I add some functions to make a <code>Blowdown</code> object act like an iterator with only a single element. This is absolutely pointless except that I just happen to like being able to generate a vector of results by using the “dot” notation, like so</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">my_function</span>.(blowdown, time_vector)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>where I want it to broadcast over the <code>time_vector</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="bu">Base</span>.<span class="fu">length</span>(<span class="op">::</span><span class="dt">Blowdown</span>) <span class="op">=</span> <span class="fl">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="bu">Base</span>.<span class="fu">iterate</span>(b<span class="op">::</span><span class="dt">Blowdown</span>, state<span class="op">=</span><span class="fl">1</span>) <span class="op">=</span> state <span class="op">&gt;</span> <span class="fu">length</span>(b) ? <span class="cn">nothing</span> <span class="op">:</span> (b,state<span class="op">+</span><span class="fl">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For the simple choked model this is fairly straight forward.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adiabatic_blowdown_choked</span>(vessel<span class="op">::</span><span class="dt">PressureVessel</span>) <span class="op">=</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">AdiabaticBlowdown</span>(vessel,<span class="cn">nothing</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">blowdown_pressure</span>(bd<span class="op">::</span><span class="dt">AdiabaticBlowdown</span>, t)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    P₀, k, τ <span class="op">=</span> bd.pv.P₀, bd.pv.k, bd.pv.τ</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">P₀*</span>( <span class="fl">1</span> <span class="op">+</span> <span class="fl">0.5</span><span class="fu">*</span>(k<span class="op">-</span><span class="fl">1</span>)<span class="fu">*</span>(t<span class="op">/</span>τ))<span class="op">^</span>((<span class="fl">2</span><span class="op">*</span>k)<span class="op">/</span>(<span class="fl">1</span><span class="op">-</span>k))</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">blowdown_mass_rate</span>(bd<span class="op">::</span><span class="dt">AdiabaticBlowdown</span>, t)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    ρ₀, V, P₀, k, τ <span class="op">=</span> bd.pv.ρ₀, bd.pv.V, bd.pv.P₀, bd.pv.k, </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                      bd.pv.τ</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    m₀ <span class="op">=</span> ρ₀<span class="op">*</span>V</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    w₀ <span class="op">=</span> m₀<span class="op">/</span>τ</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    P <span class="op">=</span> <span class="fu">blowdown_pressure</span>(bd, t)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">w₀*</span>(P<span class="op">/</span>P₀)<span class="op">^</span>((k<span class="op">+</span><span class="fl">1</span>)<span class="op">/</span>(<span class="fl">2</span>k))</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">blowdown_time</span>(bd<span class="op">::</span><span class="dt">AdiabaticBlowdown</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    P₀, Pₐ, k, τ <span class="op">=</span> bd.pv.P₀, bd.pv.Pₐ, bd.pv.k, bd.pv.τ</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="fl">2</span>τ<span class="op">/</span>(<span class="fl">1</span><span class="op">-</span>k))<span class="fu">*</span>(<span class="fl">1</span> <span class="op">-</span> (Pₐ<span class="op">/</span>P₀)<span class="op">^</span>((<span class="fl">1</span><span class="op">-</span>k)<span class="op">/</span><span class="fl">2</span>k))</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For the full model the initial step is to integrate the differential equation. As a first guess, I calculate the blowdown time for a fully choked blowdown and set the outer-bound for the integration to 10× this. The integrator will terminate when the pressure reaches ambient and thus the last time stored will be the actual blowdown time.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">adiabatic_blowdown_full</span>(vessel<span class="op">::</span><span class="dt">PressureVessel</span>; solver<span class="op">=</span><span class="fu">Tsit5</span>())</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># unpack the parameters</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    c, A, V, k, ρ₀, P₀, Pₐ <span class="op">=</span> vessel.c, vessel.A, vessel.V, </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                             vessel.k, vessel.ρ₀, vessel.P₀,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                             vessel.Pₐ</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    params <span class="op">=</span> (c, A, V, k, ρ₀, P₀, Pₐ)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># estimate the time span needed to fully blowdown</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    τ <span class="op">=</span> vessel.τ</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    t_bd <span class="op">=</span> (<span class="fl">2</span>τ<span class="op">/</span>(<span class="fl">1</span><span class="op">-</span>k))<span class="fu">*</span>(<span class="fl">1</span> <span class="op">-</span> (Pₐ<span class="op">/</span>P₀)<span class="op">^</span>((<span class="fl">1</span><span class="op">-</span>k)<span class="op">/</span><span class="fl">2</span>k))</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    t_span <span class="op">=</span> (<span class="fl">0.0</span>, <span class="fl">10</span>t_bd)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># set up the ODEProblem and solve</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    prob <span class="op">=</span> <span class="fu">ODEProblem</span>(adiabatic_vessel, P₀, t_span, params)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    sol <span class="op">=</span> <span class="fu">solve</span>(prob, solver,</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>                callback<span class="op">=</span><span class="fu">ContinuousCallback</span>(depressured_callback, terminate!))</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">AdiabaticBlowdown</span>(vessel,sol)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">blowdown_pressure</span>(bd<span class="op">::</span><span class="dt">AdiabaticBlowdown{&lt;:ODESolution}</span>, t)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> t <span class="op">&lt;</span> <span class="fu">blowdown_time</span>(bd)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> bd.<span class="fu">sol</span>(t)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> bd.sol.u[<span class="kw">end</span>]</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">blowdown_mass_rate</span>(bd<span class="op">::</span><span class="dt">AdiabaticBlowdown{&lt;:ODESolution}</span>, t)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> t <span class="op">&lt;</span> <span class="fu">blowdown_time</span>(bd)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>        <span class="co"># unpack the parameters</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>        c, A, k, ρ₀, P₀, Pₐ <span class="op">=</span> bd.pv.c, bd.pv.A, bd.pv.k,  </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>                              bd.pv.ρ₀, bd.pv.P₀, bd.pv.Pₐ</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># calculate w = c*A*G</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>        P <span class="op">=</span> <span class="fu">blowdown_pressure</span>(bd, t)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>        ρ <span class="op">=</span> <span class="fu">ρ₀*</span>(P<span class="op">/</span>P₀)<span class="op">^</span>(<span class="fl">1</span><span class="op">/</span>k)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>        G <span class="op">=</span> <span class="fu">isentropic_mass_flow</span>(P, ρ; k<span class="op">=</span>k, Pₐ<span class="op">=</span>Pₐ)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> c<span class="op">*</span>A<span class="op">*</span>G</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fl">0.0</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">blowdown_time</span>(bd<span class="op">::</span><span class="dt">AdiabaticBlowdown{&lt;:ODESolution}</span>) <span class="op">=</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    bd.sol.t[<span class="kw">end</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-2-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-2-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig-2.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-2-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: The adiabatic blowdown curves for a fully charged SCUBA tank, showing both the fully choked model and the ODE solution for pressure (top) and mass flow rate (bottom).
</figcaption>
</figure>
</div>
<p>At this point I’ve built up enough machinery that playing around with all sorts of variations to the original case become quite simple. As an example, I look at the same air tank but pressured to 1.5 atm instead.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>test_vessel <span class="op">=</span> <span class="fu">PressureVessel</span>(c, A, V, k, ρ₀, <span class="fl">1.5</span>Pₐ, Pₐ);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig-4.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: The adiabatic blowdown curve for a partially charged SCUBA tank, showing both the fully choked model and the ODE solution.
</figcaption>
</figure>
</div>
<p>Now it is clear that the fully choked model model isn’t working well, it predicts a blowdown time of 11.68s whereas numerically solving the ODE gives an answer of 20.49s, a 75.0% greater predicted blowdown.</p>
<p>That said…I’m being a little coy about something: the full ODE predicts that the vessel will <em>never</em> blowdown. The pressure will get closer and closer to ambient but never get there. This is because <em>G</em>, for non-choked flow, asymptotically approaches zero as the vessel pressure approaches ambient pressure. How you define <em>blowdown time</em> is really a function of <em>how close to ambient</em> is close enough. Even if I set the tolerance in the <code>depressured_callback</code> function, which terminates the integration once the integrator is within tolerance of the ambient pressure, to zero it would, in reality, simply terminate at the default numerical precision of <code>DifferentialEquations.jl</code>. In this case I’ve said “within 0.1% of ambient is close enough,” but that’s totally arbitrary.</p>
</section>
</section>
<section id="the-isothermal-case" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="the-isothermal-case">The Isothermal Case</h2>
<p>The other limiting case worth exploring is the isothermal case, which is equivalent to the vessel having perfectly conductive walls and remaining always at thermal equilibrium with the environment. This is often a good approximation for large vessels where the blowdown rate is small relative to the thermal mass of the gas in the vessel.</p>
<p>Recalling, for the adiabatic case, we had the following</p>
<p><span class="math display">\[
\frac{dP}{dt} = - \frac{c_D A}{V} \left( \frac{\partial P}{\partial \rho} \right)_S G
\]</span></p>
<p>For the isothermal case the vessel is being depressured along an isothermal path (not an isentropic path) and so we substitute the appropriate partial derivative<span class="citation" data-cites="botros-1989"><a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></span></p>
<div class="no-row-height column-margin column-container"><div id="fn6"><p><sup>6</sup>&nbsp;<a href="#ref-botros-1989" role="doc-biblioref">Botros, Jungowski, and Weiss, <span>“Models and Methods of Simulating Gas Pipeline Blowdown”</span></a>.</p></div></div><p><span class="math display">\[
\frac{dP}{dt} = - \frac{c_D A}{V} \left( \frac{\partial P}{\partial \rho} \right)_T G
\]</span></p>
<section id="fully-choked-flow-1" class="level3">
<h3 class="anchored" data-anchor-id="fully-choked-flow-1">Fully Choked Flow</h3>
<p>As before, the blowdown is through an isentropic nozzle and we assume that flow is choked</p>
<p><span class="math display">\[
G = \sqrt{k \rho P} \left( \frac{2}{k+1} \right)^{\frac{k+1}{2 \left( k-1 \right)} } = \rho \sqrt{ {k P} \over \rho} \left( \frac{2}{k+1} \right)^{\frac{k+1}{2 \left( k-1 \right)} }
\]</span></p>
<p>From <a href="../../posts/relief_valve_sizing/">thermodynamics</a> we can write the partial derivative as</p>
<p><span class="math display">\[
\left( \frac{\partial P}{\partial \rho} \right)_T = \frac{a^2}{k} = \frac{P}{\rho}
\]</span></p>
<p>Thus</p>
<p><span class="math display">\[
\frac{dP}{dt} = - \frac{c_D A}{V} \frac{P}{\rho} \rho \sqrt{ {k P} \over \rho} \left( \frac{2}{k+1} \right)^{\frac{k+1}{2 \left( k-1 \right)} }
\]</span></p>
<p>where the densities, <span class="math inline">\(\rho\)</span>, can be cancelled and, since the vessel is isothermal (i.e.&nbsp;<span class="math inline">\(\frac{P}{\rho}\)</span> is a constant), the various constants can be collected to give</p>
<p><span class="math display">\[
\frac{dP}{dt} = -\frac{P}{\tau}
\]</span></p>
<p>Where <span class="math inline">\(\tau\)</span> is as defined for the adiabatic case. This can easily be integrated to give</p>
<p><span class="math display">\[
\frac{P}{P_0} = \exp \left( \frac{-t}{\tau} \right)
\]</span></p>
<p>it also follows, from the ideal gas law, that</p>
<p><span class="math display">\[
\frac{\rho}{\rho_0} = \exp \left( \frac{-t}{\tau} \right)
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\frac{w}{w_0} = \exp \left( \frac{-t}{\tau} \right)
\]</span></p>
<p>This can also be rearranged to give the blowdown time[^ <em>N.B.</em> the <span class="math inline">\(\log \left( \dots \right)\)</span> is the natural log, this matches the convention used in julia]</p>
<p><span class="math display">\[
t = \tau \log \left( \frac{P_0}{P_a} \right)
\]</span></p>
</section>
<section id="in-the-literature-1" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="in-the-literature-1">In the Literature</h3>
<p>This is the equation seen most often in references for estimating blowdown time for pipelines and compressor systems. It is also what is going on under the hood with many online calculators for vessel blowdown times. Though, in my experience, this is not always well documented and a modified form is often presented.</p>
<p>The time constant, <span class="math inline">\(\tau\)</span>, can be broken up to look like this</p>
<p><span class="math display">\[
\tau = \frac{V}{c_D A} \sqrt{\frac{M}{M_{air} Z_0 T_0} } \sqrt{\frac{M_{air} }{kR} } \left( 2 \over {k+1} \right)^{\frac{-1}{2} \frac{k+1}{k-1} }
\]</span></p>
<p>Where we have made the substitution <span class="math inline">\(Z_0 R T_0\)</span> for <span class="math inline">\(R T_0\)</span> to account for non-ideal behaviour. If the gas has a value of <em>k</em> ~ 1.4, we can write</p>
<p><span class="math display">\[
\tau = \mathrm{const} \frac{V}{c_D A} \sqrt{ \frac{SG}{Z_0 T_0} }
\]</span></p>
<p>Where the constant is calculated entirely from the properties of air. Generally, I have found, few references describe where this constant comes from and in particular that it depends implicitly on a particular value for <em>k</em>. It also often has unit conversions absorbed into it, for example<span class="citation" data-cites="campbell-1992 vanec-2025"><a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></span></p>
<div class="no-row-height column-margin column-container"><div id="fn7"><p><sup>7</sup>&nbsp;<a href="#ref-campbell-1992" role="doc-biblioref">Campbell, <em>Gas Conditioning and Processing</em>, 2:29</a>; <a href="#ref-vanec-2025" role="doc-biblioref">VANEC, <span>“Pressure Volume-Blowdown Time Calculation”</span></a>.</p></div></div><p><span class="math display">\[
t = 5.5 \frac{V}{c_D A} \sqrt{ \frac{SG}{Z_0 T_0} } \log \left( \frac{P_0}{P_a} \right)
\]</span></p>
<p>with the units</p>
<ul>
<li>Blowdown time, <em>t</em>, in seconds</li>
<li>Vessel volume, <em>V</em>, in cubic feet</li>
<li>Valve flow area, <em>A</em>, in square inches</li>
<li>Initial temperature, <span class="math inline">\(T_0\)</span>, in Rankine</li>
<li>Initial pressure, <span class="math inline">\(P_0\)</span>, in psia</li>
<li>Ambient pressure, <span class="math inline">\(P_a\)</span>, in psia</li>
</ul>
<p>I have also found a few sources that leave the value of the constant as a mystery for the user to puzzle out.<span class="citation" data-cites="temizel-2019 engineers-2025"><a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a></span> I was honestly surprised at the quality of the results when I first googled this and looked it up in <a href="https://app.knovel.com/kn">Knovel</a>. The highest ranked results, at the time, were cryptic to the point of uselessness or included obvious mistakes (several referred to <em>t</em> as the “interstitial velocity” with units of cm/s, an obvious misprint being blindly recopied in several places, including some e-books on Knovel where one would hope the quality control would be better). There are a few places with useful derivations<span class="citation" data-cites="wheeler-2019 botros-1989 botros-2018 saad-1985"><a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a></span> but I think a good starting point is the <a href="http://www.et.byu.edu/~wheeler/Tank_Blowdown_Math.pdf">Tank Blowdown Math</a> set of notes. It is pretty straight forward and does not require a lot of prior knowledge of the partial derivatives of various thermodynamic state variables.</p>
<div class="no-row-height column-margin column-container"><div id="fn8"><p><sup>8</sup>&nbsp;<a href="#ref-temizel-2019" role="doc-biblioref">Temizel et al., <em>Formulas and Calculations for Petroleum Engineering</em>, 262</a>; <a href="#ref-engineers-2025" role="doc-biblioref">Engineers Edge, <span>“Blowdown Time in Unsteady Gas Flow Calculator and Equation”</span></a>.</p></div><div id="fn9"><p><sup>9</sup>&nbsp;<a href="#ref-wheeler-2019" role="doc-biblioref">Wheeler, <span>“Tank Blowdown Math”</span></a>; <a href="#ref-botros-1989" role="doc-biblioref">Botros, Jungowski, and Weiss, <span>“Models and Methods of Simulating Gas Pipeline Blowdown”</span></a>; <a href="#ref-botros-2018" role="doc-biblioref">Botros and Hardeveld, <em>Pipeline Pumping and Compression Systems - a Practical Approach</em>, 447</a>; <a href="#ref-saad-1985" role="doc-biblioref">Saad, <em>Compressible Fluid Flow</em>, 98–103</a>, to list but a few.</p></div></div><p>I personally would not bother with the models that pre-calculate the constant for you. We no longer live in the age of slide-rules. The blowdown time equation for fully choked flow is well within the capabilities of excel or any competent person with a scientific calculator. I think it is easier to justify and explain, will be a better model for gases where <em>k</em> is not 1.4, and allows one to incorporate small levels of non-ideality through the <a href="../../posts/relief_valve_sizing/#the-isentropic-expansion-factor">isentropic expansion factor</a> <em>n</em>.</p>
<p>The isothermal fully-choked model can be implemented building on the types already created, by first creating an <code>IsothermalBlowdown</code> type and associated blowdown functions</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> IsothermalBlowdown{S} <span class="op">&lt;:</span><span class="dt"> Blowdown</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    pv<span class="op">::</span><span class="dt">PressureVessel</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    sol<span class="op">::</span><span class="dt">S</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">isothermal_blowdown_choked</span>(vessel<span class="op">::</span><span class="dt">PressureVessel</span>) <span class="op">=</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">IsothermalBlowdown</span>(vessel,<span class="cn">nothing</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">blowdown_pressure</span>(bd<span class="op">::</span><span class="dt">IsothermalBlowdown</span>, t)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    P₀, τ <span class="op">=</span> bd.pv.P₀, bd.pv.τ</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">P₀*exp</span>(<span class="op">-</span>t<span class="op">/</span>τ)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">blowdown_mass_rate</span>(bd<span class="op">::</span><span class="dt">IsothermalBlowdown</span>, t)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    ρ₀, V, τ <span class="op">=</span> bd.pv.ρ₀, bd.pv.V, bd.pv.τ</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    m₀ <span class="op">=</span> ρ₀<span class="op">*</span>V</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    w₀ <span class="op">=</span> m₀<span class="op">/</span>τ</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">w₀*exp</span>(<span class="op">-</span>t<span class="op">/</span>τ)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">blowdown_time</span>(bd<span class="op">::</span><span class="dt">IsothermalBlowdown</span>) <span class="op">=</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    bd.pv.<span class="fu">τ*log</span>(bd.pv.P₀<span class="op">/</span>bd.pv.Pₐ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In a similar vein as the adiabatic case, the requirement for fully choked flow can be relaxed and the ODE integrated numerically instead, starting with the system</p>
<p><span class="math display">\[
\frac{dP}{dt} = -\frac{c_D A}{V} \frac{a^2}{k} G
\]</span></p>
<p>We can solve this numerically given that, for an isothermal system, the density is given by</p>
<p><span class="math display">\[
\rho = \rho_0 \left(\frac{P}{P_0}\right)
\]</span></p>
<p>and using the definition of <em>G</em> given in the adiabatic case.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">isothermal_vessel</span>(P, params, t)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    c, A, V, k, ρ₀, P₀, Pₐ <span class="op">=</span> params</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    ρ <span class="op">=</span> <span class="fu">ρ₀*</span>(P<span class="op">/</span>P₀)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    a² <span class="op">=</span> <span class="fu">speed_of_sound</span>(P, ρ; k<span class="op">=</span>k)<span class="op">^</span><span class="fl">2</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    G <span class="op">=</span> <span class="fu">isentropic_mass_flow</span>(P, ρ; k<span class="op">=</span>k, Pₐ<span class="op">=</span>Pₐ)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span><span class="op">-</span>c<span class="op">*</span>A<span class="op">*</span>a²<span class="op">*</span>G<span class="op">/</span>(k<span class="op">*</span>V)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">isothermal_blowdown_full</span>(vessel<span class="op">::</span><span class="dt">PressureVessel</span>; solver<span class="op">=</span><span class="fu">Tsit5</span>())</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># unpack the parameters</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    c, A, V, k, ρ₀, P₀, Pₐ <span class="op">=</span> vessel.c, vessel.A, vessel.V, </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>                             vessel.k, vessel.ρ₀, vessel.P₀,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>                             vessel.Pₐ</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    params <span class="op">=</span> (c, A, V, k, ρ₀, P₀, Pₐ)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># estimate the time span needed to fully blowdown</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    τ <span class="op">=</span> vessel.τ</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    t_bd <span class="op">=</span> <span class="fu">τ*log</span>(P₀<span class="op">/</span>Pₐ)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    t_span <span class="op">=</span> (<span class="fl">0.0</span>, <span class="fl">10</span>t_bd)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># set up the ODEProblem and solve</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    prob <span class="op">=</span> <span class="fu">ODEProblem</span>(isothermal_vessel, P₀, t_span, params)</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    sol <span class="op">=</span> <span class="fu">solve</span>(prob, solver,</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>                callback<span class="op">=</span><span class="fu">ContinuousCallback</span>(depressured_callback, terminate!))</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">IsothermalBlowdown</span>(vessel,sol)</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">blowdown_pressure</span>(bd<span class="op">::</span><span class="dt">IsothermalBlowdown{&lt;:ODESolution}</span>, t)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> t <span class="op">&lt;</span> <span class="fu">blowdown_time</span>(bd)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> bd.<span class="fu">sol</span>(t)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> bd.sol.u[<span class="kw">end</span>]</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">blowdown_mass_rate</span>(bd<span class="op">::</span><span class="dt">IsothermalBlowdown{&lt;:ODESolution}</span>, t)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> t <span class="op">&lt;</span> <span class="fu">blowdown_time</span>(bd)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>        <span class="co"># unpack the parameters</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>        c, A, k, ρ₀, P₀, Pₐ <span class="op">=</span> bd.pv.c, bd.pv.A, bd.pv.k, </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>                              bd.pv.ρ₀, bd.pv.P₀, bd.pv.Pₐ</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># calculate w = c*A*G</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>        P <span class="op">=</span> <span class="fu">blowdown_pressure</span>(bd, t)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>        ρ <span class="op">=</span> <span class="fu">ρ₀*</span>(P<span class="op">/</span>P₀)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>        G <span class="op">=</span> <span class="fu">isentropic_mass_flow</span>(P, ρ; k<span class="op">=</span>k, Pₐ<span class="op">=</span>Pₐ)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> c<span class="op">*</span>A<span class="op">*</span>G</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fl">0.0</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">blowdown_time</span>(bd<span class="op">::</span><span class="dt">IsothermalBlowdown{&lt;:ODESolution}</span>) <span class="op">=</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    bd.sol.t[<span class="kw">end</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-5-6" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-5-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig-5.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-5-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: The isothermal blowdown curves for a fully charged SCUBA tank, showing both the fully choked model and the ODE solution for pressure (top) and mass flow rate (bottom).
</figcaption>
</figure>
</div>
<p>It is a similar story to the adiabatic case: for systems with a high initial pressure, the flow out of the valve is fully choked for almost the entire blowdown. It is only in the final fraction of a second that the full ODE system deviates from the model that assumes flow is choked all the time.</p>
<p>In most practical situations, the difference would likely be swamped by two much greater problems with these models:</p>
<ol type="1">
<li>the gases are assumed be ideal with constant <em>k</em></li>
<li>the vessel is perfectly isothermal (or adiabatic)</li>
</ol>
<p>Both of these assumptions will have a much greater impact on how well the model fits observed blowdowns than the slight deviation at the end of the blowdown due to non-choked flow.</p>
</section>
</section>
<section id="comparing-blowdown-models" class="level2">
<h2 class="anchored" data-anchor-id="comparing-blowdown-models">Comparing Blowdown Models</h2>
<p>I think it might be simpler to visualize when the choked flow blowdown models will fall down by looking at the high pressure blowdown, the original example, versus the low pressure blowdown in dimensionless form. In this form, the choked flow blowdown curves (both adiabatic and isothermal) only depend on <em>k</em>. They are in fact the exact same curve. All that has changed is where along the curve the blowdown terminates.</p>
<div id="fig-7" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig-7.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: The adiabatic and isothermal blowdown curves for a fully charged SCUBA tank, in dimensionless form.
</figcaption>
</figure>
</div>
<p>In the high pressure case the blowdown terminates much closer to <span class="math inline">\(\frac{P}{P_0}=0\)</span> and most of the curve is fully choked.</p>
<div id="fig-8" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig-8.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: The adiabatic and isothermal blowdown curves for a partially charged SCUBA tank, in dimensionless form.
</figcaption>
</figure>
</div>
<p>In the low pressure case the blowdown terminates at a much steeper part of the blowdown curve and the departure for non-choking flow is much more apparent.</p>
<p>It is not immediately clear to me why the adiabatic case is all over the standard references for process safety, and the isothermal model is not. If what you care about is the pressure sustained within a vessel, the mass flow rate emitted through a blowdown stack or vent, and the duration of the blowdown, it is almost always more conservative to use the isothermal case. The isothermal (fully choked) model is also just easier to calculate, being just <span class="math inline">\(\exp \left( \frac{-t}{\tau} \right)\)</span>.</p>
<p>The adiabatic case will give a better sense of how temperature changes within the vessel. I’ve largely left it out, but adiabatic blowdown does lead to a significant temperature drop and this cryogenic cooling can be a process hazard on its own. The gas exiting, and the vessel walls themselves, will get quite cold. Anyone who has gone camping in more marginal weather and watched a one-pound propane cylinder develop frost on the outside while cooking has seen this effect in action.[^This is also why butane cylinders are often not a good idea for early spring camping (in Canada), the cooling effect is strong enough to cause the butane inside to liquefy and the stove won’t work very well.] But actually calculating the vessel temperature is almost entirely ignored in blowdown calculations for ideal gases, in my experience.</p>
<p>The isothermal model, in my review of the literature, appeared to be more commonly used in operational contexts, such as estimating the time required to blowdown a system through a blowdown vent. In this case it is likely to be the conservative answer. The two curves do cross at high <span class="math inline">\(\frac{t}{\tau}\)</span> and so it is not <em>always</em> the case that the isothermal model is more conservative. Something worth noting.</p>
</section>
<section id="final-thoughts" class="level2">
<h2 class="anchored" data-anchor-id="final-thoughts">Final Thoughts</h2>
<p>I deliberately set up the ODEs such that there is a clear path to implementing a real gas model through an equation of state. All that really needs to be done is to create functions for these three steps:</p>
<ol type="1">
<li>the speed of sound</li>
<li>the density as a function of pressure, either along an isentropic path (in the adiabatic case) or along an isothermal path</li>
<li>the isentropic mass velocity, <em>G</em></li>
</ol>
<p>Plugging those into the relevant steps in the <code>adiabatic_vessel</code> and <code>isothermal_vessel</code> functions changes from the ideal gas case to the real gas case. The rest of the code remains the same and operates unchanged.</p>
<p>In this case I think solving the full ODE for the ideal gas case alone is probably not worth the effort for most cases. The error in assuming an ideal gas, or in assuming one of the limiting heat transfer cases, is probably far larger than the error in assuming fully choked flow for all but the few cases that are near atmospheric pressure. If you are going to be estimating the blowdown for a real gas, then that’s different. If you are going to the hassle of setting up and solving the ODE, might as well have as few unnecessary assumptions as you can get away with. It really isn’t any more <em>person</em> effort, at that point, just more <em>computer</em> effort, and when the calculations happen in less than a second, how much less than a second is of little practical importance.</p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-botros-1989" class="csl-entry" role="listitem">
Botros, K. K., W. M. Jungowski, and M. H. Weiss. <span>“Models and Methods of Simulating Gas Pipeline Blowdown.”</span> <em>The Canadian Journal of Chemical Engineering</em> 67 (1989): 529–39. <a href="https://doi.org/10.1002/cjce.5450670402">https://doi.org/10.1002/cjce.5450670402</a>.
</div>
<div id="ref-botros-2018" class="csl-entry" role="listitem">
Botros, Kamal K., and Thomas Van Hardeveld. <em>Pipeline Pumping and Compression Systems - a Practical Approach</em>. 3rd ed. New York: ASME Press, 2018.
</div>
<div id="ref-campbell-1992" class="csl-entry" role="listitem">
Campbell, John M. <em>Gas Conditioning and Processing</em>. Vol. 2. Tulsa, OK: John M. Campbell &amp; Co, 1992.
</div>
<div id="ref-crowl-2008" class="csl-entry" role="listitem">
Crowl, Daniel A., Lawrence G. Britton, Walter L. Frank, Stanley Grossel, Dennis Hendershot, W. G. High, Robert W. Johnson, et al. <span>“Process Safety.”</span> In <em>Perry’s Chemical Engineers’ Handbook</em>, edited by Don W. Green, 8th ed. New York: McGraw Hill, 2008.
</div>
<div id="ref-engineers-2025" class="csl-entry" role="listitem">
Engineers Edge. <span>“Blowdown Time in Unsteady Gas Flow Calculator and Equation,”</span> 2025. <a href="https://www.engineersedge.com/calculators/blowdown_time_in_unsteady_gas_16011.htm">https://www.engineersedge.com/calculators/blowdown_time_in_unsteady_gas_16011.htm</a>.
</div>
<div id="ref-laidler-2003" class="csl-entry" role="listitem">
Laidler, Keith J., John H. Meiser, and Bryan C. Sanctuary. <em>Physical Chemistry</em>. 4th ed. Boston, MA: Houghton Mifflin Co, 2003.
</div>
<div id="ref-lees-1996" class="csl-entry" role="listitem">
Lees, Frank P. <em>Loss Prevention in the Process Industries</em>. 2nd ed. Oxford: Butterworth-Heinemann, 1996.
</div>
<div id="ref-saad-1985" class="csl-entry" role="listitem">
Saad, Michel A. <em>Compressible Fluid Flow</em>. Englewood Cliffs, NJ: Prentiss-Hall, 1985.
</div>
<div id="ref-temizel-2019" class="csl-entry" role="listitem">
Temizel, Cenk, Tayfun Tuna, Mehmet Melik Oskay, and Luigi Saputelli. <em>Formulas and Calculations for Petroleum Engineering</em>. Cambridge, MA: Gulf Professional Publishing, 2019.
</div>
<div id="ref-tilton-2008" class="csl-entry" role="listitem">
Tilton, James N. <span>“Fluid and Particle Dynamics.”</span> In <em>Perry’s Chemical Engineers’ Handbook</em>, edited by Don W. Green, 8th ed. New York: McGraw Hill, 2008.
</div>
<div id="ref-vanec-2025" class="csl-entry" role="listitem">
VANEC. <span>“Pressure Volume-Blowdown Time Calculation,”</span> 2025. <a href="https://www.vanec.com/pressurized-volume-blowdown-time-calculation.html">https://www.vanec.com/pressurized-volume-blowdown-time-calculation.html</a>.
</div>
<div id="ref-wheeler-2019" class="csl-entry" role="listitem">
Wheeler, Dean R. <span>“Tank Blowdown Math,”</span> 2019. <a href="http://www.et.byu.edu/~wheeler/Tank_Blowdown_Math.pdf">http://www.et.byu.edu/~wheeler/Tank_Blowdown_Math.pdf</a>.
</div>
</div>


</section>


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/aefarrell\.github\.io");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<script src="https://utteranc.es/client.js" repo="aefarrell/aefarrell.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->




</body></html>