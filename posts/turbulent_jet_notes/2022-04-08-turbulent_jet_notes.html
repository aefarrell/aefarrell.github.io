<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>turbulent_jet_notes – A Chemical Engineer's Notebook</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-59228ce9c52eba116baca5d538563979.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: #ffffff;
      }

      .quarto-title-block .quarto-title-banner {
        color: #ffffff;
background: url(../../images/pipes-unsplash-header.jpg);
      }
</style>
<style>
.quarto-title-block .quarto-title-banner {
  min-height: 100%;
  background-size: cover;
  box-shadow: inset 0 0 0 2000px rgba(0, 0, 0, 0.3);
}
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="A Chemical Engineer’s Notebook">
<meta property="og:description" content="A collection of notebooks about chemical engineering and analysis">
<meta property="og:image" content="https://aefarrell.github.io/images/turbulent_jet_notes_files/att1.png">
<meta property="og:site_name" content="A Chemical Engineer's Notebook">
</head>

<body class="floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">A Chemical Engineer’s Notebook</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> <i class="bi bi-info-circle" role="img">
</i> 
<span class="menu-text">about</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html"> <i class="bi bi-wrench-adjustable-circle" role="img">
</i> 
<span class="menu-text">projects</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block"></header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="3">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#turbulent-jets" id="toc-turbulent-jets" class="nav-link active" data-scroll-target="#turbulent-jets">Turbulent Jets</a>
  <ul class="collapse">
  <li><a href="#observations-on-turbulent-jets" id="toc-observations-on-turbulent-jets" class="nav-link" data-scroll-target="#observations-on-turbulent-jets">Observations on Turbulent Jets</a></li>
  <li><a href="#modeling-turbulent-jets" id="toc-modeling-turbulent-jets" class="nav-link" data-scroll-target="#modeling-turbulent-jets">Modeling Turbulent Jets</a>
  <ul class="collapse">
  <li><a href="#time-averaged-values" id="toc-time-averaged-values" class="nav-link" data-scroll-target="#time-averaged-values">Time Averaged Values</a></li>
  <li><a href="#equations-of-motion" id="toc-equations-of-motion" class="nav-link" data-scroll-target="#equations-of-motion">Equations of Motion</a></li>
  <li><a href="#equation-of-continuity" id="toc-equation-of-continuity" class="nav-link" data-scroll-target="#equation-of-continuity">Equation of Continuity</a></li>
  <li><a href="#stokes-stream-function" id="toc-stokes-stream-function" class="nav-link" data-scroll-target="#stokes-stream-function">Stokes Stream Function</a></li>
  <li><a href="#boundary-conditions" id="toc-boundary-conditions" class="nav-link" data-scroll-target="#boundary-conditions">Boundary Conditions</a></li>
  <li><a href="#momentum-balance" id="toc-momentum-balance" class="nav-link" data-scroll-target="#momentum-balance">Momentum Balance</a></li>
  </ul></li>
  <li><a href="#prandtl-mixing-length" id="toc-prandtl-mixing-length" class="nav-link" data-scroll-target="#prandtl-mixing-length">Prandtl Mixing Length</a>
  <ul class="collapse">
  <li><a href="#setting-up-the-ode" id="toc-setting-up-the-ode" class="nav-link" data-scroll-target="#setting-up-the-ode">Setting up the ODE</a></li>
  <li><a href="#solving-the-ode" id="toc-solving-the-ode" class="nav-link" data-scroll-target="#solving-the-ode">Solving the ODE</a></li>
  <li><a href="#comparison-with-tollmien" id="toc-comparison-with-tollmien" class="nav-link" data-scroll-target="#comparison-with-tollmien">Comparison with Tollmien</a></li>
  <li><a href="#width-at-half-height" id="toc-width-at-half-height" class="nav-link" data-scroll-target="#width-at-half-height">Width at Half Height</a></li>
  <li><a href="#velocity-profile" id="toc-velocity-profile" class="nav-link" data-scroll-target="#velocity-profile">Velocity Profile</a></li>
  </ul></li>
  <li><a href="#eddy-viscosity" id="toc-eddy-viscosity" class="nav-link" data-scroll-target="#eddy-viscosity">Eddy Viscosity</a>
  <ul class="collapse">
  <li><a href="#setting-up-the-ode-1" id="toc-setting-up-the-ode-1" class="nav-link" data-scroll-target="#setting-up-the-ode-1">Setting up the ODE</a></li>
  <li><a href="#width-at-half-height-1" id="toc-width-at-half-height-1" class="nav-link" data-scroll-target="#width-at-half-height-1">Width at Half Height</a></li>
  <li><a href="#velocity-profile-1" id="toc-velocity-profile-1" class="nav-link" data-scroll-target="#velocity-profile-1">Velocity Profile</a></li>
  </ul></li>
  <li><a href="#empirical-velocity-profiles" id="toc-empirical-velocity-profiles" class="nav-link" data-scroll-target="#empirical-velocity-profiles">Empirical Velocity Profiles</a>
  <ul class="collapse">
  <li><a href="#width-at-half-height-2" id="toc-width-at-half-height-2" class="nav-link" data-scroll-target="#width-at-half-height-2">Width at Half Height</a></li>
  <li><a href="#velocity-profile-2" id="toc-velocity-profile-2" class="nav-link" data-scroll-target="#velocity-profile-2">Velocity Profile</a></li>
  </ul></li>
  <li><a href="#comparing-the-models" id="toc-comparing-the-models" class="nav-link" data-scroll-target="#comparing-the-models">Comparing the Models</a></li>
  <li><a href="#where-to-go-from-here" id="toc-where-to-go-from-here" class="nav-link" data-scroll-target="#where-to-go-from-here">Where to go from here</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">




<section id="turbulent-jets" class="level1 page-columns page-full">
<h1>Turbulent Jets</h1>
<p>In <a href="https://aefarrell.github.io/2021/04/10/turbulent_jet_example/">a previous post</a> I worked through a chemical release modeled as a turbulent jet and while I mentioned there were several ways modeling the jet, I didn’t go into any of them. I’m taking the opportunity here to collect my notes on turbulent jets, some different ways of modeling the jets, and the relative performance of each approach.</p>
<section id="observations-on-turbulent-jets" class="level2">
<h2 class="anchored" data-anchor-id="observations-on-turbulent-jets">Observations on Turbulent Jets</h2>
<p>We are considering a submerged circular jet, issuing from a surface, with the coordinate system centered on the jet. Since it is circular, the natural coordinate system is cylindrical with a downstream distance <em>z</em>, radial distance <em>r</em>, and angular coordinate <em>θ</em>. The jet is fully turbulent when the Reynolds number, <span class="math inline">\(Re \gt 2000\)</span>, where the Reynolds number is calculated with respect to the initial jet velocity and jet diameter</p>
<p><span class="math display">\[ Re = { \rho_j v_0 d_0 \over \mu_j } \]</span></p>
<p>We are also considering the case where the densities of the two fluids are similar, where we take “similar” to mean <span class="math display">\[ \frac{1}{4} \le { \rho_{a} \over \rho_{j} } \le 4 \]</span></p>
<p>Where subscript <em>a</em> indicates the ambient fluid and <em>j</em> the jet. For much the experimental data the jet and ambient fluid are the same fluid, e.g.&nbsp;a jet of air into air or water into water.</p>
<p>Turbulent jets expand by entraining ambient fluid, tracing out a cone defined by a jet angle <span class="math inline">\(\alpha \approx 15-25^\circ\)</span>. The mixing layer penetrates into the jet forming the potential core, inside is pure jet material and outside is mixed. After approximately 6 diameters the region is fully developed.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/turbulent_jet_notes_files/att1.png" class="img-fluid figure-img"></p>
<figcaption>image.png</figcaption>
</figure>
</div>
<p>Empirical approximations of the velocity profile are often given with respect to this jet angle or, equivalently, the slope of the line (i.e.&nbsp;<span class="math inline">\(\tan \frac{\alpha}{2}\)</span>). A related way of parameterizing the jet is in terms of a width parameter <em>b</em>. Typically this is the width of the velocity profile at half-height <span class="math inline">\(b_{1/2}\)</span> (though not always). With a constant jet angle and a self-similar velocity profile the width is directly proportional to the downstream distance $ b_{1/2} = ( ) z = c z$.</p>
<p>Where the value of <em>c</em> is can be found in the literature</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">c</th>
<th style="text-align: left;">Reference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.082 - 0.097</td>
<td style="text-align: left;">Garde (<a href="#garde-2010">2010</a>)</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.0848</td>
<td style="text-align: left;">Bird, Stewart, and Lightfoot (<a href="#bird-2007">2007</a>)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.10</td>
<td style="text-align: left;">Rajaratnam (<a href="#rajaratnam-1974">1974</a>)</td>
</tr>
</tbody>
</table>
<p>At this point it is common to introduce a variable <span class="math inline">\(\xi = {r \over b_{1/2} }\)</span> or <span class="math inline">\(\xi = {r \over z }\)</span> where we are taking advantage of the fact that $ b_{1/2} z $. This is a <em>scaled</em> radial distance, using the width at half-height as a characteristic length. It is important to keep track of which definition of ξ is being used as they differ by a scaling factor. The reason for this change of variables is the observation that the <em>shape</em> of the velocity profile is the same at any downstream point, it is merely scaled down in height and wider as one travels downstream. That is <span class="math display">\[{ \bar{v}_z \over \bar{v}_{max} } = f \left( \xi \right)\]</span> is the same for all downstream distances (in the region where the jet is fully developed).</p>
<p>Another important observation is that the center-line velocity, the max velocity in the jet, decays with the inverse of the downstream distance, i.e.</p>
<p><span class="math display">\[ \bar{v}_{max} \propto z^{-1} \]</span></p>
<p>Putting those two observations together we expect the velocity profile to have the form</p>
<p><span class="math display">\[ \bar{v}_z = { \mathrm{const} \over z } f \left( \xi \right)\]</span></p>
</section>
<section id="modeling-turbulent-jets" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="modeling-turbulent-jets">Modeling Turbulent Jets</h2>
<p>To set up our system we consider the case of a jet coming out of a point on an infinite surface into a quiescent medium, and that the jet and medium have the same density. This is a major simplification, but it makes the math easier to deal with. The coordinate system is centered at this point and all momentum in the jet ultimately comes from the origin.</p>
<p>The boundary conditions for the problem are: 1. at the center-line, <em>r=0</em>, the velocity is entirely in the z-direction 1. at the center-line, <em>r=0</em>, the velocity in the z-direction is at a maximum 1. as the radius increases, <em>r → ∞</em> , the velocity in the z-direction goes to zero</p>
<section id="time-averaged-values" class="level3">
<h3 class="anchored" data-anchor-id="time-averaged-values">Time Averaged Values</h3>
<p>Since we are concerned with turbulent flow, we can employ <a href="https://en.wikipedia.org/wiki/Reynolds_decomposition">Reynolds decomposition</a> to transform the velocities like so</p>
<p><span class="math display">\[ v_z = \bar{v}_z + v^{\prime}_{z} \]</span></p>
<p><span class="math display">\[ v_r = \bar{v}_r + v^{\prime}_{r} \]</span></p>
<p>where <span class="math inline">\(\bar{v}\)</span> is the time-smoothed velocity and <span class="math inline">\(v^{\prime}\)</span> is an instantaneous deviation such that <span class="math inline">\(\bar{v^{\prime} } = 0\)</span> and the time-averaging operator follows the <a href="https://en.wikipedia.org/wiki/Reynolds_operator">Reynolds criteria</a>.</p>
</section>
<section id="equations-of-motion" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="equations-of-motion">Equations of Motion</h3>
<p>The equations of motion in terms of time-smoothed velocities are <span class="math display">\[ \rho {D \mathbf{\bar{v} } \over D t } = - \nabla \bar{p} - \nabla \cdot \mathbf{ \bar{\tau} } + \rho \mathbf{g}  \]</span></p>
<p>Where <span class="math inline">\(\mathbf{ \bar{\tau} }\)</span> is the turbulent stress and includes the <a href="https://en.wikipedia.org/wiki/Reynolds_stress">Reynolds stresses</a>.</p>
<p>With the z component, in cylindrical coordinates<a href="#fn-1" class="sidenote-number"></a><span id="fn-1" class="sidenote"><a href="#bird-2007">Bird, Stewart, and Lightfoot</a>. <em>Transport Phenomena</em>, 847.</span></p>
<p><span class="math display">\[ \rho \left( {\partial \over \partial t} \bar{v}_z + \bar{v}_r {\partial \bar{v}_z \over \partial r} + {\bar{v}_\theta \over r} {\partial \bar{v}_z \over \partial \theta} + \bar{v}_z {\partial \bar{v}_z \over \partial z} \right)
\\ = - {\partial \bar{p} \over \partial z} - {1 \over r} {\partial \left( r \bar{\tau}_{rz} \right) \over \partial r } - {1 \over r} {\partial \bar{\tau}_{\theta z} \over \partial \theta } - {\partial \bar{\tau}_{z z} \over \partial z } + \rho g_z\]</span></p>
<p>Making the assumptions: 1. Zero pressure gradient ( <span class="math inline">\({\partial p \over \partial z} = 0\)</span> ) 1. Steady state ( <span class="math inline">\({\partial \over \partial t} \left( \cdots \right) = 0\)</span> ) 1. Axisymmetric ( <span class="math inline">\({\partial \over \partial \theta} \left( \cdots \right) = 0\)</span> ) 1. Effect of gravity can be neglected ( $ g_z $ ) 1. Within the jet $ v_z v_r $ and, by boundarly layer approximation, $ {}_{z z} $ can be neglected<a href="#fn-2" class="sidenote-number"></a></p>
<p>{% capture footnote-2 %} The boundary layer approximation is that</p>
<p><span class="math display">\[ { \partial^2 \bar{v}_z \over \partial z^2 } \ll { \partial^2 \bar{v}_z \over \partial r^2 } \]</span></p>
<p>and if we suppose that</p>
<p><span class="math display">\[ \bar{\tau}_{z z} \propto { \partial \bar{v}_z \over \partial z } \]</span></p>
<p>and</p>
<p><span class="math display">\[ \bar{\tau}_{r z} \propto {\partial \bar{v}_z \over \partial r} \]</span></p>
<p>we find</p>
<p><span class="math display">\[ { \partial \bar{\tau}_{z z} \over \partial z } \propto {\partial^2 \bar{v}_z \over \partial z^2} \ll { \partial r \bar{\tau}_{r z} \over \partial r} \propto {\partial^2 \bar{v}_z \over \partial r^2} \]</span></p>
<p>and thus we can assume the free turbulence is dominated by $ {}_{r z} $ and</p>
<p><span class="math display">\[ { \partial \bar{\tau}_{z z} \over \partial z} \approx 0 \]</span> {% endcapture %}</p>
<aside class="sidenote" id="fn-2">
{{ footnote-2 | markdownify }}
</aside>
<p>The equations of motion, in the z direction, simplifies to</p>
<p><span class="math display">\[ \bar{v}_r {\partial \bar{v}_z \over \partial r} + \bar{v}_z {\partial \bar{v}_z \over \partial z} = - {1 \over \rho r} {\partial \left( r \bar{\tau}_{rz} \right) \over \partial r } \]</span></p>
</section>
<section id="equation-of-continuity" class="level3">
<h3 class="anchored" data-anchor-id="equation-of-continuity">Equation of Continuity</h3>
<p>The continuity equation in terms of time-smoothed velocities is</p>
<p><span class="math display">\[ {\partial \rho \over \partial t} + \nabla \cdot \rho \mathbf{ \bar{v} } = 0 \]</span></p>
<p>In cylindrical coordinates</p>
<p><span class="math display">\[ {\partial \rho \over \partial t} + {1 \over r} {\partial \rho r \bar{v}_r \over \partial r} + {1 \over r} { \partial \rho \bar{v}_\theta \over \partial \theta} + {\partial \rho \bar{v}_z \over \partial z} = 0 \]</span></p>
<p>Making the assumptions: 1. Steady state ( <span class="math inline">\({\partial \over \partial t} \left( \cdots \right) = 0\)</span> ) 1. Axisymmetric ( <span class="math inline">\({\partial \over \partial \theta} \left( \cdots \right) = 0\)</span> ) 1. Incompressible ( ${z} = {r} = {} = 0 $ )</p>
<p>The equation of continuity simplifies to</p>
<p><span class="math display">\[ {1 \over r} {\partial r \bar{v}_r \over \partial r} + {\partial \bar{v}_z \over \partial z} = 0 \]</span></p>
</section>
<section id="stokes-stream-function" class="level3">
<h3 class="anchored" data-anchor-id="stokes-stream-function">Stokes Stream Function</h3>
<p>To simplify things down to working with one dependent variable we introduce a <a href="https://en.wikipedia.org/wiki/Stokes_stream_functionhttps://en.wikipedia.org/wiki/Stokes_stream_function">Stokes stream function</a> <span class="math inline">\(\psi\)</span> defined such that</p>
<p><span class="math display">\[ \bar{v}_z = -{1 \over r} {\partial \psi \over \partial r} \]</span></p>
<p>and</p>
<p><span class="math display">\[ \bar{v}_r = {1 \over r} {\partial \psi \over \partial z} \]</span></p>
<p>This definition ensures that the equation of continuity is satisfied. Suppose that $ = k z F() $, where <em>F</em> is a unitless function of <span class="math inline">\(\xi = \frac{r}{z}\)</span> and <span class="math inline">\(k\)</span> is a constant with units $ [[ ]]^2 ]^{-1} $, then</p>
<p><span class="math display">\[ \bar{v}_z = -{1 \over r} {\partial \xi \over \partial r} {\partial \psi \over \partial \xi}
= -{1 \over r} {1 \over z} {k z F^{\prime} } \\
\\= -{k \over z} {F^{\prime} \over \xi} = { \mathrm{const} \over z } f \left( \xi \right)\]</span></p>
<p>Which matches what we expect from the empirical observations (which is why we supposed that form of the stream function in the first place). We can use this definition to work out some other useful terms</p>
<p><span class="math display">\[ {\partial \bar{v}_z \over \partial z} = {k \over z^2} F^{\prime \prime} \]</span></p>
<p><span class="math display">\[ {\partial \bar{v}_z \over \partial r} = -{k \over z^2} \left( { F^{\prime \prime} \over \xi} - { F^{\prime} \over \xi^2} \right) \]</span></p>
<p><span class="math display">\[ \bar{v}_r = { k \over z } \left( { F \over \xi } - F^{\prime} \right) \]</span></p>
<p>Substituting these back into the equation of motion, in the z direction, leads to</p>
<p><span class="math display">\[ \left( k \over z \right)^2 \left[ { F F^{\prime \prime} \over \xi } - {F F^{\prime} \over \xi^2} + { \left( F^{\prime} \right)^2 \over \xi } \right]  = {1 \over \rho} {\partial \over \partial r} \left( r \bar{\tau}_{rz} \right) \]</span></p>
<p><span class="math display">\[ \left( k \over z \right)^2 { d \over d \xi } \left( F F^{\prime} \over \xi \right) = {1 \over \rho} {\partial \over \partial r} \left( r \bar{\tau}_{rz} \right) \]</span></p>
<p>Which is suggestive of the overall approach to follow: find an expression for the right hand side of this differential equation, integrate both sides with respect to <em>ξ</em>, and solve for <em>F(ξ)</em></p>
</section>
<section id="boundary-conditions" class="level3">
<h3 class="anchored" data-anchor-id="boundary-conditions">Boundary Conditions</h3>
<p>The initial boundary conditions of the problem were that: 1. <span class="math inline">\(\bar{v}_r = 0\)</span> at <em>r=0</em> 1. <span class="math inline">\({\partial \bar{v}_z \over \partial r} = 0\)</span> at <em>r=0</em> (i.e.&nbsp;the velocity is at a maximum) 1. <span class="math inline">\(\bar{v}_z \to 0\)</span> as <em>r → ∞</em> (i.e.&nbsp;the velocity decays to zero)</p>
<p>In terms of <em>F</em> and <em>ξ</em> these become: 1. <span class="math inline">\({F \over \xi} - F^{\prime} = 0\)</span> at <em>ξ=0</em>, which implies <em>F=0</em> at <em>ξ=0</em> 1. <span class="math inline">\(F^{\prime \prime} - {F^{\prime} \over \xi}  = 0\)</span> at <em>ξ=0</em> 1. <span class="math inline">\({F^{\prime} \over \xi} \to 0\)</span> as <em>ξ → ∞</em></p>
</section>
<section id="momentum-balance" class="level3">
<h3 class="anchored" data-anchor-id="momentum-balance">Momentum Balance</h3>
<p>To determine the constant <em>k</em> we use a momentum balance: the momentum flux, <em>J</em>, in the z direction is constant. Initially the momentum flux is</p>
<p><span class="math display">\[ J = \rho v_0^2 A_0 = \rho v_0^2 {\pi \over 4} d_0^2\]</span></p>
<p>and at some point <em>z</em> downstream of the origin we have</p>
<p><span class="math display">\[ J = \int_{0}^{2\pi} \int_{0}^{\infty} \rho \bar{v}_z^2 r dr d\theta \\
     = 2 \pi \rho \int_{0}^{\infty} \bar{v}_{z,max}^2 \left( \bar{v}_z \over \bar{v}_{z,max} \right)^2 r dr \\
     = 2 \pi \rho \bar{v}_{z,max}^2 \int_{0}^{\infty} \left( \bar{v}_z \over \bar{v}_{z,max} \right)^2 r dr \\
     = 2 \pi \rho k^2 \int_{0}^{\infty} \left( f\left( \xi \right) \right)^2 \xi d \xi \]</span></p>
<p>Taking the integral to be <em>I</em>, and equating the initial momentum flux with the momentum flux at point <em>z</em><a href="#fn-4" class="sidenote-number"></a><span id="fn-4" class="sidenote">I’ve played a little fast and loose with the definition of <span class="math inline">\(\bar{v}_z\)</span> in that I am implicitly assuming <span class="math inline">\(f(\xi) = {-F^{\prime}(\xi) \over \xi}\)</span> which isn’t strictly true, there can be scaling factor. In practice all of these are collected together into one constant so it doesn’t matter, but that is something to be aware of as the definition of <em>k</em> here is really <span class="math inline">\(k\times \mathrm{const}\)</span> where $ = {-F^{}() } f() $</span></p>
<p><span class="math display">\[ J = \rho v_0^2 {\pi \over 4} d_0^2 = 2 \pi \rho k^2 I \]</span></p>
<p><span class="math display">\[ k = \sqrt{1 \over 8 I } v_0 d_0 \]</span></p>
</section>
</section>
<section id="prandtl-mixing-length" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="prandtl-mixing-length">Prandtl Mixing Length</h2>
<p>The Prandtl mixing length model makes the assumption that momentum transfer occurs over some “mixing length” <em>l</em> such that</p>
<p><span class="math display">\[ \bar{\tau}_{rz} = -\rho l^2 \left| {\partial \bar{v}_z \over \partial r} \right| \left( {\partial \bar{v}_z \over \partial r} \right)\]</span></p>
<p>We suppose that the mixing length is proportional to the width of the velocity profile <span class="math inline">\(b_{1/2}\)</span>, the characteristic length for the velocity profile, which we know is proportional to the downstream distance <em>z</em></p>
<p><span class="math display">\[ l \propto b_{1/2} \propto z\]</span></p>
<p><span class="math display">\[ l = c z \]</span></p>
<p>Where <span class="math inline">\(c\)</span> is some unitless constant. Making the observation that $ {{v}_z r} &lt; 0 $ we can make the simplification</p>
<p><span class="math display">\[ \bar{\tau}_{rz} = \rho c^2 z^2 \left( {\partial \bar{v}_z \over \partial r} \right)^2\]</span></p>
<section id="setting-up-the-ode" class="level3">
<h3 class="anchored" data-anchor-id="setting-up-the-ode">Setting up the ODE</h3>
<p>Recall that the equation of motion in the z direction is (in terms of the unitless function <em>F</em>) is</p>
<p><span class="math display">\[ \left( k \over z \right)^2 { d \over d \xi } \left( F F^{\prime} \over \xi \right) = {1 \over \rho} {\partial \over \partial r} \left( r \bar{\tau}_{rz} \right) \]</span></p>
<p>Substituting the expression for $ {}_{rz} $ we have</p>
<p><span class="math display">\[ \left( k \over z \right)^2 { d \over d \xi } \left( F F^{\prime} \over \xi \right) = c^2 z^2 {\partial \over \partial r} \left( r \left( \partial \bar{v}_{z} \over \partial r \right)^2 \right) \]</span></p>
<p><span class="math display">\[ \left( k \over z \right)^2 { d \over d \xi } \left( F F^{\prime} \over \xi \right) = c^2 z^2 \left( \left( \partial \bar{v}_{z} \over \partial r \right)^2 + 2r \left( \partial \bar{v}_{z} \over \partial r \right) \left( \partial^2 \bar{v}_{z} \over \partial r^2 \right) \right) \]</span></p>
<p>Substituting in the expressions for $ {{v}_z r} $ and $ {^2 {v}_z r^2} $ we arrive at</p>
<p><span class="math display">\[ \left( k \over z \right)^2 { d \over d \xi } \left( F F^{\prime} \over \xi \right) = c^2 \left(k \over z \right)^2 \left( 1 \over \xi \right)\left( F^{\prime \prime} - { F^{\prime} \over \xi } \right) \left(  2 F^{\prime \prime \prime} - 3 { F^{\prime \prime} \over \xi } + { F^{\prime} \over \xi^2 }\right) \]</span></p>
<p><span class="math display">\[ { d \over d \xi } \left( F F^{\prime} \over \xi \right) = c^2 { d \over d \xi } \left( 1 \over \xi \right)\left( F^{\prime \prime} - { F^{\prime} \over \xi } \right)^2 \]</span></p>
<p>Integrating both sides</p>
<p><span class="math display">\[ \left( F F^{\prime} \over \xi \right) = c^2 \left( 1 \over \xi \right)\left( F^{\prime \prime} - { F^{\prime} \over \xi } \right)^2 + \mathrm{const}\]</span></p>
<p>By applying the boundary conditions we find the constant of integration is zero, thus</p>
<p><span class="math display">\[ F F^{\prime} = c^2 \left( F^{\prime \prime} - { F^{\prime} \over \xi } \right)^2 \]</span></p>
<p>Making the substitution $ = a^{-1} $ where $ a = c^{2/3} $</p>
<p><span class="math display">\[ F F^{\prime} = \left( F^{\prime \prime} - { F^{\prime} \over \phi } \right)^2 \]</span></p>
<p><span class="math display">\[ F^{\prime \prime} = { F^{\prime} \over \phi } + \sqrt{ F F^{\prime} } \]</span></p>
<p>Which is in a form that can be solved numerically.</p>
</section>
<section id="solving-the-ode" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="solving-the-ode">Solving the ODE</h3>
<p>We can solve the ODE and perform the integral needed for the momentum balance at the same time. First we define a vector <em>u</em> such that:</p>
<p><span class="math display">\[ \mathbf{u} =  \begin{bmatrix} u_{1} \\ u_{2} \end{bmatrix} = \begin{bmatrix} F \\ F^{\prime} \end{bmatrix}\]</span></p>
<p>The ODE then becomes:</p>
<p><span class="math display">\[ {d \mathbf{u} \over dt } = \begin{bmatrix} F^{\prime} \\ F^{\prime \prime} \end{bmatrix}  = \begin{bmatrix} u_{2} \\ \frac{ u_{2} }{t} + \sqrt{ u_{1} u_{2} } \end{bmatrix} \]</span></p>
<p>Which has a singularity at <em>t=0</em>, but one that can be easily dealt with by setting the initial value of the derivatives to<a href="#fn-5" class="sidenote-number"></a></p>
<p>{% capture footnote-5 %} From the boundary conditions we know <em>F’(0) = 0</em> but what about <em>F’’</em>? Taking the ratio</p>
<p><span class="math display">\[ { \bar{v}_z \over \bar{v}_{z,max} }_{r=0} = - {F^{\prime} \over \phi }_{\phi=0} = 1 \]</span></p>
<p>we find <span class="math inline">\({F^{\prime} \over \phi } = -1\)</span> at <em>φ = 0</em> and, from the boundary conditions,</p>
<p><span class="math display">\[ F^{\prime \prime} = {F^{\prime} \over \phi } \]</span></p>
<p>at <em>φ = 0</em>, therefore <em>F’’(0) = -1</em> {% endcapture %}</p>
<p>{% capture footnote-6 %} Because of how <span class="math inline">\(\bar{v}_z\)</span> and <span class="math inline">\(\bar{v}_r\)</span> were defined $ -{ F^{} } $, i.e.&nbsp;$ { F^{} } $. For the signs to work out, $ F $ and $ F^{} $ (since <span class="math inline">\(F F^{\prime} \ge 0\)</span>) <a href="#fnref-6">↩︎</a> {% endcapture %}</p>
<aside class="sidenote">
{{ footnote-5 | markdownify }} <strong id="fn-6">5: </strong>{{ footnote-6 | markdownify }}
</aside>
<p><span class="math display">\[ {d \mathbf{u} \over dt }_{t=0} = \begin{bmatrix} 0 \\ -1 \end{bmatrix}\]</span></p>
<p>Putting that together, the ODE can be integrated easily<a href="#fn-6" class="sidenote-number"></a>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StaticArrays</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">DifferentialEquations</span>: ODEProblem, Tsit5, solve, TerminateSteadyState</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">sys</span>(u,p,t)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    u₁, u₂ <span class="op">=</span> u[<span class="fl">1</span>], u[<span class="fl">2</span>]</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> t <span class="op">&gt;</span> <span class="fl">0.0</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>        du₁ <span class="op">=</span> u₂</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>        du₂ <span class="op">=</span> u₂<span class="op">/</span>t <span class="op">+</span> <span class="fu">√</span>(<span class="fu">max</span>((u₁<span class="op">*</span>u₂),<span class="fl">0</span>))</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>        du₁ <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>        du₂ <span class="op">=</span> <span class="op">-</span><span class="fl">1.0</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> SA[du₁; du₂]</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>u0    <span class="op">=</span> SA[<span class="fl">0.0</span>; <span class="fl">0.0</span>]</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>tspan <span class="op">=</span> (<span class="fl">0.0</span>, <span class="fl">6.0</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>prob  <span class="op">=</span> <span class="fu">ODEProblem</span>(sys, u0, tspan)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>sol   <span class="op">=</span> <span class="fu">solve</span>(prob, <span class="fu">Tsit5</span>(), dtmax<span class="op">=</span><span class="fl">0.1</span>, callback<span class="op">=</span><span class="fu">TerminateSteadyState</span>())</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sol.retcode)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>Success</code></pre>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/turbulent_jet_notes_files/output_13_0.svg" class="img-fluid figure-img"></p>
<figcaption>svg</figcaption>
</figure>
</div>
<p>Using the solution in terms of φ we can write a function <em>f(ξ)</em></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">f_pml</span>(ξ; a<span class="op">=</span><span class="fl">0.066</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    ϕ <span class="op">=</span> <span class="fu">abs</span>(ξ)<span class="op">/</span>a</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ϕ <span class="op">&gt;</span><span class="fl">0</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        F, F′ <span class="op">=</span> <span class="fu">sol</span>(ϕ)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        f <span class="op">=</span> <span class="op">-</span>F′<span class="op">/</span>ϕ</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>        f  <span class="op">=</span> <span class="fu">max</span>(f, <span class="fl">0</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        f <span class="op">=</span> <span class="fl">1</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> f</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="comparison-with-tollmien" class="level3">
<h3 class="anchored" data-anchor-id="comparison-with-tollmien">Comparison with Tollmien</h3>
<p>The classic treatment of the Prandtl mixing length model is from <a href="#tollmien-1926">Tollmien</a><a href="#fn-7" class="sidenote-number"></a><span id="fn-7" class="sidenote"><a href="#tollmien-1926">Tollmien</a>, “Berechnung turbulenter Ausbreitungsvorgänge,” 468-478.</span> in which, instead of solving numerically in the way shown above, the ODE is further transformed and a series expansion is used to generate a table of results. More often than not it is these tabulated values, or similar ones<a href="#fn-8" class="sidenote-number"></a><span id="fn-8" class="sidenote"><a href="#rajaratnam-1974">Rajaratnam</a> <em>Turbulent Jets</em>, 39.<br> The table has an error at φ=1: the value of <span class="math inline">\({F^{\prime} \over \phi }\)</span> should be 0.606 but is given as 0.505 (presumably a typo)</span>, that are presented as the solution to the model.</p>
<p>We can easily compare the result here with the tabulated values and verify for ourselves that we have indeed solved the right differential equation. Though by solving numerically in this way we can control the level of precision and easily generate smooth interpolations. In my opinion, this makes using the ODE solution far more convenient than the tabulated values.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/turbulent_jet_notes_files/output_19_0.svg" class="img-fluid figure-img"></p>
<figcaption>svg</figcaption>
</figure>
</div>
</section>
<section id="width-at-half-height" class="level3">
<h3 class="anchored" data-anchor-id="width-at-half-height">Width at Half Height</h3>
<p>The width at half height, <span class="math inline">\(b_{1/2}\)</span>, is an important parameter and often velocity profiles are scaled relative to this. To compare different models on a fair basis, it is a good idea to determine what the model parameters are relative to <span class="math inline">\(b_{1/2}\)</span>. Then each model can be scaled to the same <span class="math inline">\(b_{1/2}\)</span> and compared, apples-to-apples.</p>
<p>In this case we don’t have a closed form for the velocity profile so we need to solve for φ such that <em>f(φ)=0</em> numerically.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Roots</span>: find_zero</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>ϕ_half <span class="op">=</span> <span class="fu">find_zero</span>( ϕ <span class="op">-&gt;</span> <span class="fu">f_pml</span>(ϕ; a<span class="op">=</span><span class="fl">1</span>)<span class="op">-</span><span class="fl">0.5</span>, (<span class="fl">1</span>, <span class="fl">1.25</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>1.2277667062444657</code></pre>
<p>and we then write the model parameter <em>a</em> in terms of <span class="math inline">\(b_{1/2}\)</span></p>
<p><span class="math display">\[ a = \frac{1}{ \phi_{1/2} } \frac{ b_{1/2} }{z} = 0.814 \frac{ b_{1/2} }{z} \]</span></p>
<p>Using a default value for <span class="math inline">\({ b_{1/2} \over z } = 0.0848\)</span> we arrive at</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>b_half <span class="op">=</span> <span class="fl">0.0848</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> b_half<span class="op">/</span>ϕ_half</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>0.06906849613098656</code></pre>
<p>Several sources have tabulated values for <em>a</em></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">a</th>
<th style="text-align: left;">Reference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.063</td>
<td style="text-align: left;">Tollmien (<a href="#tollmien-1926">1926</a>)</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.066</td>
<td style="text-align: left;">Rajaratnam (<a href="#rajaratnam-1974">1974</a>)</td>
</tr>
</tbody>
</table>
<p>and the result of this notebook compares with those</p>
</section>
<section id="velocity-profile" class="level3">
<h3 class="anchored" data-anchor-id="velocity-profile">Velocity Profile</h3>
<p>Now that we have completed the integration we can calculate the parameter <em>k</em>, using the equation derived from the momentum balance</p>
<p><span class="math display">\[ k = \sqrt{1 \over 8 I } v_0 d_0 \]</span></p>
<p>with the value of the integral coming directly from the ode solver</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">NumericalIntegration</span>: integrate</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>ϕ, F′ <span class="op">=</span> sol.t, sol[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># trim any unphysical values</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>F′[F′<span class="op">.&gt;</span><span class="fl">0</span>] <span class="op">.=</span> <span class="fl">0.0</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">integrand</span>(ϕ, F′)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ϕ<span class="op">&gt;</span><span class="fl">0</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> F′<span class="op">^</span><span class="fl">2</span><span class="op">/</span>ϕ</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fl">0</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>I <span class="op">=</span> <span class="fu">integrate</span>(ϕ, <span class="fu">integrand</span>.(ϕ, F′))</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>I <span class="op">=</span> a<span class="op">^</span><span class="fl">2</span> <span class="op">*</span> I</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>0.002573069044757039</code></pre>
<p>Allowing us to write the velocity profile as</p>
<p><span class="math display">\[ \bar{v}_z = 6.97 { v_0 d_0 \over z} f(\xi) \]</span></p>
</section>
</section>
<section id="eddy-viscosity" class="level2">
<h2 class="anchored" data-anchor-id="eddy-viscosity">Eddy Viscosity</h2>
<p>The eddy viscosity model makes the assumption that the turbulent shear stress depends on the rate of strain in a manner that is analogous to laminar flow, with the constant of proportionality being the <em>eddy viscosity</em> ε:</p>
<p><span class="math display">\[ \bar{\tau}_{rz} = - \rho \varepsilon {\partial \bar{v}_z \over \partial r}\]</span></p>
<section id="setting-up-the-ode-1" class="level3">
<h3 class="anchored" data-anchor-id="setting-up-the-ode-1">Setting up the ODE</h3>
<p>Recall that the equation of motion in the z direction is (in terms of the unitless function <em>F</em>)</p>
<p><span class="math display">\[ \left( k \over z \right)^2 { d \over d \xi } \left( F F^{\prime} \over \xi \right) = {1 \over \rho} {\partial \over \partial r} \left( r \bar{\tau}_{rz} \right) \]</span></p>
<p>Substituting the expression for $ {}_{rz} $ we have</p>
<p><span class="math display">\[ \left( k \over z \right)^2 { d \over d \xi } \left( F F^{\prime} \over \xi \right) = - \varepsilon {\partial \over \partial r} \left( r \left( \partial \bar{v}_{z} \over \partial r \right) \right) \]</span></p>
<p><span class="math display">\[ \left( k \over z \right)^2 { d \over d \xi } \left( F F^{\prime} \over \xi \right) = - \varepsilon \left( \left( \partial \bar{v}_{rz} \over \partial r \right) + r \left( \partial^2 \bar{v}_{rz} \over \partial r^2 \right) \right) \]</span></p>
<p>Substituting in the expressions for $ {{v}_z r} $ and $ {^2 {v}_z r^2} $ we arrive at</p>
<p><span class="math display">\[ \left( k \over z \right)^2 { d \over d \xi } \left( F F^{\prime} \over \xi \right) = { k \varepsilon \over z^2} \left( F^{\prime \prime \prime} - { F^{\prime \prime} \over \xi } + { F^{\prime} \over \xi^2 }  \right) \]</span></p>
<p><span class="math display">\[ \left( k \over z \right)^2 { d \over d \xi } \left( F F^{\prime} \over \xi \right) = { k \varepsilon \over z^2} { d \over d \xi } \left( F^{\prime \prime} - { F^{\prime} \over \xi } \right) \]</span></p>
<p>at this point we note that <em>k</em> and ε have the same units of $ [[ ]]^2 ]^{-1} $ and are independent of <em>z</em> and ξ, so we propose that $ = c k $ where <em>c</em> is some unknown constant of proportionality.</p>
<p><span class="math display">\[ \left( k \over z \right)^2 { d \over d \xi } \left( F F^{\prime} \over \xi \right) = c \left( k \over z \right)^2 { d \over d \xi } \left( F^{\prime \prime} - { F^{\prime} \over \xi } \right) \]</span></p>
<p><span class="math display">\[ { d \over d \xi } \left( F F^{\prime} \over \xi \right) = c { d \over d \xi } \left( F^{\prime \prime} - { F^{\prime} \over \xi } \right) \]</span></p>
<p>Integrating both sides</p>
<p><span class="math display">\[ { F F^{\prime} \over \xi } = c \left( F^{\prime \prime} - { F^{\prime} \over \xi } \right) + \mathrm{const}\]</span></p>
<p>By applying the boundary conditions we find the constant of integration is zero, thus</p>
<p><span class="math display">\[ F F^{\prime} = c \left( \xi F^{\prime \prime} -  F^{\prime} \right) \]</span></p>
<p><span class="math display">\[{ d \over d \xi } \left( \frac{1}{2} F^2 \right) = c { d \over d \xi } \left( \xi F^{\prime} -  2 F \right) \]</span></p>
<p>Integrating both sides</p>
<p><span class="math display">\[ \frac{1}{2} F^2 = c \left( \xi F^{\prime} -  2 F \right) + \mathrm{const}\]</span></p>
<p>By applying the boundary conditions we find the constant of integration is zero, thus</p>
<p><span class="math display">\[ c \xi F^{\prime} = \frac{1}{2} F^2 +  2c F \]</span></p>
<p>Which is separable</p>
<p><span class="math display">\[ \int { d \xi \over \xi} = \int { c \over {\frac{1}{2} F^2 +  2c F} } dF \]</span></p>
<p>Integrating one last time</p>
<p><span class="math display">\[ \log \left( C_1 \xi \right) = \frac{1}{2} \log \left( F \over F + 4 c \right) \]</span></p>
<p>Where <em>C<sub>1</sub></em> is an undetermined constant of integration. Re-arranging and solving for <em>F</em> we arrive at</p>
<p><span class="math display">\[ F\left( \xi \right) = { 4 c C_1 \xi^2 \over {1 - C_1 \xi^2 } } \]</span></p>
<p>A common substitution is $ C_1 = - ( C_2 )^2 $ then</p>
<p><span class="math display">\[ F\left( \xi \right) = { - c \left( C_2 \xi \right)^2 \over {1 + \frac{1}{4} \left( C_2 \xi \right)^2 } } \]</span></p>
<p>What we need, for the velocity profile, is the first derivative of <em>F</em>, which is</p>
<p><span class="math display">\[ F^{\prime}\left( \xi \right) = { - 2 c C_2^2 \xi \over \left( 1 + \left( C_2 \xi \over 2 \right)^2 \right)^2 } \]</span></p>
<p>and finally</p>
<p><span class="math display">\[ \bar{v}_z = -{k \over z} {F^{\prime} \over \xi} \\
= -{k \over z} { 1 \over \xi }{ - 2 c C_2^2 \xi \over \left( 1 + \left( C_2 \xi \over 2 \right)^2 \right)^2 } \\
= {2 \varepsilon C_2^2 \over z} \left( 1 + \left( C_2 \xi \over 2 \right)^2 \right)^{-2} \]</span></p>
<p><span class="math display">\[ f \left( \xi \right) = { \bar{v}_z \over \bar{v}_{z,max} } =  \left( 1 + \left( C_2 \xi \over 2 \right)^2 \right)^{-2} \]</span></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f_ev</span>(ξ; C₂<span class="op">=</span><span class="fl">15.1</span>) <span class="op">=</span> ( <span class="fl">1</span> <span class="op">+</span> (C₂<span class="op">*</span>ξ<span class="op">/</span><span class="fl">2</span>)<span class="op">^</span><span class="fl">2</span> )<span class="op">^-</span><span class="fl">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="width-at-half-height-1" class="level3">
<h3 class="anchored" data-anchor-id="width-at-half-height-1">Width at Half Height</h3>
<p>Since we have a convenient closed form for the velocity profile, we can calculate what the parameter <span class="math inline">\(C_2\)</span> is in terms of the width at half height rather easily.</p>
<p><span class="math display">\[ f(\xi) =  \left( 1 + \left( C_2 \xi \over 2 \right)^2 \right)^{-2} \]</span></p>
<p><span class="math display">\[ \frac{1}{2} =  \left( 1 + \left( {C_2 \over 2} { b_{1/2} \over z }\right)^2 \right)^{-2} \]</span></p>
<p><span class="math display">\[ C_2 = 2 \sqrt{\sqrt{2}-1} \frac{z}{ b_{1/2} } \]</span></p>
<p>using the same parameterization as above we get</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>C₂ <span class="op">=</span> <span class="fl">2</span><span class="fu">*√</span>(<span class="fu">√</span>(<span class="fl">2</span>)<span class="op">-</span><span class="fl">1</span>)<span class="op">/</span>b_half</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>15.179109738339214</code></pre>
</section>
<section id="velocity-profile-1" class="level3">
<h3 class="anchored" data-anchor-id="velocity-profile-1">Velocity Profile</h3>
<p>Returning to the momentum balance, we need to solve the integral:</p>
<p><span class="math display">\[ I = \int_{0}^{\infty} f\left( \xi \right)^2 \xi d \xi\\
= \int_{0}^{\infty} \xi \left( 1 + \left( C_2 \xi \over 2 \right)^2 \right)^{-4} d\xi \]</span></p>
<p>Which <a href="https://www.wolframalpha.com/input?i2d=true&amp;i=Integrate%5B%CE%BE*Power%5B%5C%2840%291%2BDivide%5B1%2C4%5DPower%5Bc*%CE%BE%2C2%5D%5C%2841%29%2C-4%5D%2C%7B%CE%BE%2C0%2C%E2%88%9E%7D%5D">can be integrated</a> to give <span class="math display">\[ I = {2 \over 3} C_2^{-2} \]</span></p>
<p>and finally</p>
<p><span class="math display">\[ k = \sqrt{ 3 \over 16 } C_2 v_0 d_0 \]</span></p>
<p>with the velocity profile as</p>
<p><span class="math display">\[ \bar{v}_z = 6.57 { v_0 d_0 \over z} \left( 1 + 57.6 \xi^2 \right)^{-2} \]</span></p>
</section>
</section>
<section id="empirical-velocity-profiles" class="level2">
<h2 class="anchored" data-anchor-id="empirical-velocity-profiles">Empirical Velocity Profiles</h2>
<p>Perhaps the most widely used turbulent jet model is simply an empirical gaussian fit to the data. These are easy to use – no solving of ODEs required – and fitting them to data is relatively straight forward. There is no real theoretical basis that I am aware of, merely based on the observation that a gaussian function fits the velocity profile well.</p>
<p><span class="math display">\[ f \left( \xi \right) = \exp \left( -c \xi^2 \right) \]</span></p>
<p>Where <em>c</em> is a parameter determined by fitting to a dataset.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f_emp</span>(ξ; c<span class="op">=</span><span class="fl">72</span>) <span class="op">=</span> <span class="fu">exp</span>(<span class="op">-</span>c<span class="op">*</span>ξ<span class="op">^</span><span class="fl">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="width-at-half-height-2" class="level3">
<h3 class="anchored" data-anchor-id="width-at-half-height-2">Width at Half Height</h3>
<p>Since we have a convenient closed form for the velocity profile, we can calculate what the parameter <span class="math inline">\(c\)</span> is in terms of the width at half height rather easily</p>
<p><span class="math display">\[ f(\xi) =  \exp \left( -c \xi^2 \right) \]</span></p>
<p><span class="math display">\[ \frac{1}{2} =  \exp \left( - c  \left( \frac{ b_{1/2} }{z} \right)^2 \right) \]</span></p>
<p><span class="math display">\[ c = \ln \left( 2 \right) \left( \frac{z}{ b_{1/2} } \right)^2 \]</span></p>
<p>using the same parameterization as above we get</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> <span class="fu">log</span>(<span class="fl">2</span>)<span class="op">/</span>b_half<span class="op">^</span><span class="fl">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>96.39039423504045</code></pre>
</section>
<section id="velocity-profile-2" class="level3">
<h3 class="anchored" data-anchor-id="velocity-profile-2">Velocity Profile</h3>
<p>Returning to the momentum balance, we need to solve the integral:</p>
<p><span class="math display">\[ I = \int_{0}^{\infty} f\left( \xi \right)^2 \xi d \xi\\
= \int_{0}^{\infty} \xi \exp \left( -2 c \xi^2 \right) d\xi \]</span></p>
<p>Which <a href="https://www.wolframalpha.com/input?i2d=true&amp;i=Integrate%5B%CE%BE*Exp%5B-2*c*Power%5B%CE%BE%2C2%5D%5D%2C%7B%CE%BE%2C0%2C%E2%88%9E%7D%5D">can be integrated</a> to give</p>
<p><span class="math display">\[ I = {1 \over 4 c} \]</span></p>
<p>and finally</p>
<p><span class="math display">\[ k = \sqrt{ c \over 2 } v_0 d_0 \]</span></p>
<p>with the velocity profile as</p>
<p><span class="math display">\[ \bar{v}_z = 6.94 { v_0 d_0 \over z} \exp\left( -193.0 \xi^2 \right) \]</span></p>
</section>
</section>
<section id="comparing-the-models" class="level2">
<h2 class="anchored" data-anchor-id="comparing-the-models">Comparing the Models</h2>
<p>At this point two models of velocity were derived using different models of the free turbulent stress and one purely empirical model was introduced. Each of these models uses a different set of parameters, and have different strengths and weaknesses in terms of usability. To compare them like-for-like we can scale each to the same width at half height, which is shown below along with some measured data<a href="#fn-9" class="sidenote-number"></a><span id="fn-9" class="sidenote"><a href="#pope-2000">Pope</a>, <em>Turbulent Flows</em>. Points captured from a figure using <a href="https://automeris.io/WebPlotDigitizer">WebPlotDigitizer</a></span></p>
<p>We can also calculate a Mean Square Error (MSE) and evaluate which model is a better fit to the observed velocity profile.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/turbulent_jet_notes_files/output_46_0.svg" class="img-fluid figure-img"></p>
<figcaption>svg</figcaption>
</figure>
</div>
<pre><code>Prandtl Mixing Length Model MSE 0.00051
Eddy Viscosity Model        MSE 0.00092
Gaussian (empirical) Model  MSE 0.00054</code></pre>
<p>Interestingly the Prandtl mixing length model works the best, though the gaussian fit is close enough as to be essentially the same given this data set. Which is convenient as a gaussian fit is easier to work with. The eddy viscosity model is the easiest to derive, however it clearly does not work as well for the outer parts of the jet.</p>
<p>The above approach, the one you will most likely see in the literature, compares each model scaled to the same height and width. Which is sensible if one is planning on fitting data, and allowing that the height and width to be free parameters. However we know, from the analysis above, that the height of each model is dependent upon the width, so might be instructive to look at how that plays out in practice.</p>
<p>Suppose we are looking at a velocity profile far enough downstream to be in the fully developed flow, say $ z = 7 d_0 $</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/turbulent_jet_notes_files/output_48_0.svg" class="img-fluid figure-img"></p>
<figcaption>svg</figcaption>
</figure>
</div>
<p>Note that in the region near the center-line the three models are no longer particularly close to one another and the eddy viscosity and prandtl mixing length models have changed places. Relative to the predicted <span class="math inline">\(v_{max}\)</span> the the eddy viscosity model stays high when compared to the prandtl mixing length model, however the eddy viscosity model predicts a lower <span class="math inline">\(v_{max}\)</span> such that the effect is entirely reversed.</p>
<p>It’s also worth noting that the gaussian fit and the prandtl mixing length model track one another reasonably well. I have seen a gaussian fit <em>of</em> the Tollmien tabulated results used in some papers when a smooth interpolation of the intermediate values is required and this suggests that may not be a bad idea. Though, to me, just solving the ode is easier. On a modern machine it takes milliseconds or less and a good ode package like <code>DifferentialEquations.jl</code> provides a higher-order interpolation for free.</p>
<p>This comparison has been done with each of the model parameters set based on a shared width. However there are as many different ways of arriving at the model parameters as there are datasets to fit against. There is a wide spread in tabulated values in the literature and so the predictions of two independently arrived at models can be quite different due all of these factors coming together.</p>
</section>
<section id="where-to-go-from-here" class="level2">
<h2 class="anchored" data-anchor-id="where-to-go-from-here">Where to go from here</h2>
<p>All of this work was to determine the <em>velocity</em> field, which is not necessarily what anyone cares about. In a release scenario, for example, it is concentration that is most relevant. For a heat transfer application, perhaps, you may care about the temperature field instead. However, with the velocity field the concentrations, temperatures, total entrained flow, etc. can be easily derived.</p>
<p>For a complete listing of code used to generate data and figures, please see the <a href="https://github.com/aefarrell/aefarrell.github.io/blob/main/_notebooks/2022-04-08-turbulent_jet_notes.ipynb">corresponding julia notebook</a> {: .notice–info}</p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<ul>
<li><a name="bird-2007">Bird</a>, R. Byron, Warren E. Stewart, and Edwin N. Lightfoot. <em>Transport Phenomena</em>. 2nd ed.&nbsp;Hoboken: John Wiley &amp; Sons, 2007. <a href="https://archive.org/details/transportphenome0000bird_n8h5">archive</a></li>
<li><a name="garde-2010">Garde</a>, R. J. <em>Turbulent Flows</em>. 3rd ed.&nbsp;London: New Academic Science, 2010.</li>
<li><a name="pope-2000">Pope</a>, Stephen B. <em>Turbulent Flows</em>. Cambridge: Cambridge University Press, 2000.</li>
<li><a name="rajaratnam-1974">Rajaratnam</a> N. <em>Turbulent Jets</em>. Amsterdam: Elsevier, 1974.</li>
<li><a name="tollmien-1926">Tollmien</a>, Walter. “Berechnung turbulenter Ausbreitungsvorgänge,” <em>Zeitschrift für angewandte Mathematik und Mechanik</em> <em>6</em>, (1926): 468-478. <a href="https://doi.org/10.1002/zamm.19260060604">doi:10.1002/zamm.19260060604</a>, reprinted and translated in <a href="https://ntrs.nasa.gov/search?reportNumber=NACA-TM-1085">NACA-TM-1085</a></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/aefarrell\.github\.io");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<script src="https://utteranc.es/client.js" repo="aefarrell/aefarrell.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->




</body></html>